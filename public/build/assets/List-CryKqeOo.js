import{_ as m}from"./GuestLayout-bBxymfPb.js";import y from"./PermutaDetails-CX4bAbHm.js";import{q as c,i as g,o as a,c as p,w as h,a as e,t as r,g as i,m as _,A as C,n,z as k,e as u,h as b,F as f,f as L}from"./app-Akv9Yec1.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Banner-D423G76r.js";import"./PermutaRejectReasonModal-c1H2B4S5.js";import"./PermutaApproveConfirmationModal-BlOawuP0.js";import"./PermutaApprovedModal-CzSukrMT.js";import"./PermutaRejectedModal-TXoWLP3t.js";const P={components:{GuestLayout:m,PermutaDetails:y},props:["supervisor"],data(){return{todaysDate:new Date().toLocaleDateString("es-ES",{weekday:"short",year:"numeric",month:"short",day:"numeric"}).replace(/^\w/,t=>t.toUpperCase()),selectedFilter:"todos",selectedSubregion:"",selectedLocation:"",permutas:[],searchQuery:"",showDetailModal:!1,selectedPermuta:null,subregions:[],locations:[]}},computed:{filteredPermutas(){return this.permutas.filter(t=>this.selectedFilter==="approved"?t.supervisor_status.toLowerCase()==="approved"&&t.gerente_status.toLowerCase()==="approved"&&t.trade_status.toLowerCase()==="approved":this.selectedFilter==="rejected"?t.supervisor_status.toLowerCase()==="rejected"||t.gerente_status.toLowerCase()==="rejected"||t.trade_status.toLowerCase()==="rejected":this.selectedFilter==="pending"?t.supervisor_status.toLowerCase()==="pending"||t.gerente_status.toLowerCase()==="pending"||t.trade_status.toLowerCase()==="pending":!0).filter(t=>(this.selectedSubregion===""||t.location.subregion.name===this.selectedSubregion)&&(this.selectedLocation===""||t.location.name===this.selectedLocation)&&(t.cod_cliente.includes(this.searchQuery)||t.location.name.includes(this.searchQuery)))},approvedCount(){return this.permutas.filter(t=>t.supervisor_status.toLowerCase()==="approved"&&t.gerente_status.toLowerCase()==="approved"&&t.trade_status.toLowerCase()==="approved").length},pendingCount(){return this.permutas.filter(t=>t.supervisor_status.toLowerCase()==="pending"||t.gerente_status.toLowerCase()==="pending"||t.trade_status.toLowerCase()==="pending").length}},methods:{async getPermutas(){try{const t=await c.get("/gerente/permutas");this.permutas=t.data}catch(t){console.error("Error fetching permutas:",t)}},async getSubregions(){try{const t=await c.get("/api/subregions/list");this.subregions=t.data}catch(t){console.error("Error fetching subregions:",t)}},async getLocations(){try{const t=await c.get("/gerente/locations");this.locations=t.data}catch(t){console.error("Error fetching locations:",t)}},statusClass(t){switch(t.toLowerCase()){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},statusIcon(t){switch(t.toLowerCase()){case"approved":return"fa-solid fa-check";case"rejected":return"fa-solid fa-x";case"pending":return"fa-solid fa-spinner";default:return"fa-solid fa-question"}},openDetailModal(t){this.selectedPermuta=t,this.showDetailModal=!0},logout(){c.post("/logout").then(t=>{window.location.href="/login"}).catch(t=>{console.error("Error during logout:",t)})}},mounted(){this.getPermutas(),this.getSubregions(),this.getLocations()}},D={class:"grid grid-cols-2 gap-4 items-center"},j={class:"font-bold text-sm text-black leading-tight"},S=e("p",{class:"text-sm"},"Gerente de Sala",-1),A={class:"flex flex-col gap-4"},E={class:"bg-white shadow-md rounded-lg overflow-hidden flex"},M={class:"flex-1 border-r border-gray-200"},R={class:"p-4"},G=e("div",{class:"text-sm font-semibold"},[e("i",{class:"fa-solid fa-check-circle text-green-500"}),i(" Aprobadas ")],-1),T={class:"text-xs pt-2 pl-4"},z=e("span",{class:"font-bold"}," Cantidad: ",-1),V={class:"flex-1 text-left"},B={class:"p-4 text-left"},Q=e("div",{class:"text-sm text-black font-bold"},[e("i",{class:"fa-solid fa-clock text-yellow-500"}),i(" Restantes ")],-1),N={class:"text-xs mt-1 font-medium text-gray-500"},U={class:"px-2"},q={class:"relative mx-auto text-gray-600 w-full"},H=e("h2",{class:"font-bold text-sm text-black leading-tight pt-4 pb-2"}," Lista de Permutas ",-1),I={class:"flex gap-2 my-4 px-2"},J={class:"flex gap-2 my-4 px-2"},K=e("option",{value:""},"T. Localidades",-1),O=["value"],W={class:"p-2 overflow-hidden shadow-xl sm:rounded-lg"},X={class:"flex flex-col gap-4"},Y={class:"w-full md:w-3/5 border-r border-gray-200"},Z={class:"p-4"},$={class:"text-sm font-semibold"},ee=e("i",{class:"fa-solid fa-user"},null,-1),te={class:"text-xs flex items-center justify-between"},se={class:"bg-gray-100 rounded pt-1 pl-2 pb-1 pr-2 flex-3/4"},oe=e("i",{class:"fa-brands fa-square-letterboxd mr-2"},null,-1),re={class:"flex-1/4 text-right"},le=e("hr",null,null,-1),ne={class:"mt-2"},ae={class:"overflow-x-auto"},ie={class:"min-w-full bg-white"},de={class:"w-full md:w-2/5 text-left"},ce={class:"pb-2 px-4 text-left"},ue={class:"text-sm text-black font-bold"},ge={class:"text-xs mt-1 font-medium text-gray-500"},pe={class:"text-xs font-medium text-gray-500 mt-4"},he=["onClick"];function _e(t,l,be,fe,o,d){const x=g("PermutaDetails"),v=g("GuestLayout");return a(),p(v,{title:"Permutas | EDF"},{header:h(()=>[e("div",D,[e("div",null,[e("h2",j," ¡Hola, "+r(t.$page.props.auth.user.name)+" ! ",1),S])])]),default:h(()=>[e("div",A,[e("div",E,[e("div",M,[e("div",R,[G,e("div",T,[z,i(" "+r(d.approvedCount),1)])])]),e("div",V,[e("div",B,[Q,e("div",N," Cantidad: "+r(d.pendingCount),1)])])])]),e("div",U,[e("div",q,[H,_(e("input",{class:"border-2 border-gray-300 bg-white h-10 px-5 pr-16 rounded-lg text-sm focus:outline-none w-full",type:"search",name:"search",placeholder:"Buscar","onUpdate:modelValue":l[0]||(l[0]=s=>o.searchQuery=s)},null,512),[[C,o.searchQuery]])])]),e("div",I,[e("button",{class:n(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="todos","bg-white text-black":o.selectedFilter!=="todos"}]),onClick:l[1]||(l[1]=s=>o.selectedFilter="todos")},"Todos",2),e("button",{class:n(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="approved","bg-white text-black":o.selectedFilter!=="approved"}]),onClick:l[2]||(l[2]=s=>o.selectedFilter="approved")},"Aprobadas",2),e("button",{class:n(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="rejected","bg-white text-black":o.selectedFilter!=="rejected"}]),onClick:l[3]||(l[3]=s=>o.selectedFilter="rejected")},"Rechazadas",2),e("button",{class:n(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="pending","bg-white text-black":o.selectedFilter!=="pending"}]),onClick:l[4]||(l[4]=s=>o.selectedFilter="pending")},"Pendientes",2)]),e("div",J,[_(e("select",{"onUpdate:modelValue":l[5]||(l[5]=s=>o.selectedLocation=s),class:"form-select mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},[K,(a(!0),u(f,null,b(o.locations,s=>(a(),u("option",{key:s.id,value:s.name},r(s.name),9,O))),128))],512),[[k,o.selectedLocation]])]),e("div",W,[e("div",X,[(a(!0),u(f,null,b(d.filteredPermutas,s=>(a(),u("div",{key:s.id,class:"bg-white shadow-md rounded-lg overflow-hidden flex flex-col md:flex-row"},[e("div",Y,[e("div",Z,[e("div",$,[ee,i(" "+r(s.cod_cliente)+" - "+r(s.location.name),1)]),e("div",te,[e("div",se,[oe,i(" "+r(s.have_edf?"Cuenta con EDF":"No cuenta con EDF"),1)]),e("div",re,r(s.volume)+" CU ",1)]),le,e("div",ne,[e("div",ae,[e("table",ie,[e("thead",null,[e("tr",null,[e("th",{class:n(["py-2 px-4 border-b border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",{"bg-gray-100":s.instance_status==="Supervisor"}])}," Supervisor",2),e("th",{class:n(["py-2 px-4 border-b border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",{"bg-gray-100":s.instance_status==="Gerente"}])}," Gerente ",2),e("th",{class:n(["py-2 px-4 border-b border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",{"bg-gray-100":s.instance_status==="Trade"}])}," Trade",2)])]),e("tbody",null,[e("tr",null,[e("td",{class:n(["py-2 px-4 border-b border-gray-200 text-sm",{"font-bold":s.instance_status==="Supervisor"}])},r(s.supervisor_status==="Pending"?"Pendiente":s.supervisor_status==="Rejected"?"Rechazado":s.supervisor_status==="Approved"?"Aprobado":s.supervisor_status),3),e("td",{class:n(["py-2 px-4 border-b border-gray-200 text-sm",{"font-bold":s.instance_status==="Gerente"}])},r(s.gerente_status==="Pending"?"Pendiente":s.gerente_status==="Rejected"?"Rechazado":s.gerente_status==="Approved"?"Aprobado":s.gerente_status),3),e("td",{class:n(["py-2 px-4 border-b border-gray-200 text-sm",{"font-bold":s.instance_status==="Trade"}])},r(s.trade_status==="Pending"?"Pendiente":s.trade_status==="Rejected"?"Rechazado":s.trade_status==="Approved"?"Aprobado":s.trade_status),3)])])])])])])]),e("div",de,[e("div",ce,[e("div",ue,r(s.condition)+" - "+r(s.doors_to_negotiate)+" "+r(s.doors_to_negotiate===1?"Puerta":"Puertas"),1),e("div",ge," Ruta: "+r(s.route),1),e("div",pe,[e("button",{class:"bg-red-500 text-white font-bold py-1 px-2 rounded-md w-full",onClick:w=>d.openDetailModal(s)},"Ver más",8,he)]),o.showDetailModal?(a(),p(x,{key:0,show:o.showDetailModal,permuta:o.selectedPermuta,haveAvailableLimit:t.haveAvailableLimit,sv:t.mesa,onClose:l[6]||(l[6]=w=>o.showDetailModal=!1)},null,8,["show","permuta","haveAvailableLimit","sv"])):L("",!0)])])]))),128))])])]),_:1})}const Pe=F(P,[["render",_e]]);export{Pe as default};
