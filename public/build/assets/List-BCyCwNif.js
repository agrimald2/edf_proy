import{_ as y}from"./GuestLayout-Cqg7_Uxc.js";import C from"./PermutaDetails-DDw419n_.js";import{j as u,l as h,o as d,c as f,w as p,a as e,t as n,g as a,m as _,y as x,s as k,n as i,e as c,h as b,F as v,f as g}from"./app-mf1bNAMd.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Banner-Cogl3Hln.js";import"./PermutaRejectReasonModal-71DQxKWF.js";import"./PermutaApproveConfirmationModal-BR46m7rj.js";import"./PermutaApprovedModal-DpXnk43u.js";import"./PermutaRejectedModal-C0QvcKrJ.js";const j={components:{GuestLayout:y,PermutaDetails:C},props:["supervisor"],data(){const s=new Date().toLocaleString("es-ES",{month:"long"}).toLowerCase();return{todaysDate:new Date().toLocaleDateString("es-ES",{weekday:"short",year:"numeric",month:"short",day:"numeric"}).replace(/^\w/,r=>r.toUpperCase()),selectedFilter:"todos",selectedSubregion:"",selectedLocation:"",selectedMonth:s,permutas:[],searchQuery:"",showDetailModal:!1,selectedPermuta:null,subregions:[],locations:[]}},computed:{filteredPermutas(){return this.permutas.filter(s=>this.selectedFilter==="approved"?s.supervisor_status.toLowerCase()==="approved"&&s.gerente_status.toLowerCase()==="approved"&&s.trade_status.toLowerCase()==="approved":this.selectedFilter==="rejected"?s.supervisor_status.toLowerCase()==="rejected"||s.gerente_status.toLowerCase()==="rejected"||s.trade_status.toLowerCase()==="rejected":this.selectedFilter==="pending"?(s.supervisor_status.toLowerCase()==="pending"||s.gerente_status.toLowerCase()==="pending"||s.trade_status.toLowerCase()==="pending")&&s.supervisor_status.toLowerCase()!=="rejected"&&s.gerente_status.toLowerCase()!=="rejected"&&s.trade_status.toLowerCase()!=="rejected":!0).filter(s=>(this.selectedSubregion===""||s.location.subregion.name===this.selectedSubregion)&&(this.selectedLocation===""||s.location.name===this.selectedLocation)&&(s.cod_cliente.includes(this.searchQuery)||s.location.name.includes(this.searchQuery)))},approvedCount(){return this.permutas.filter(s=>s.supervisor_status.toLowerCase()==="approved"&&s.gerente_status.toLowerCase()==="approved"&&s.trade_status.toLowerCase()==="approved").length},pendingCount(){return this.permutas.filter(s=>(s.supervisor_status.toLowerCase()==="pending"||s.gerente_status.toLowerCase()==="pending"||s.trade_status.toLowerCase()==="pending")&&s.supervisor_status.toLowerCase()!=="rejected"&&s.gerente_status.toLowerCase()!=="rejected"&&s.trade_status.toLowerCase()!=="rejected").length}},methods:{async getPermutas(){try{const s=await u.get("/gerente/permutas");this.permutas=s.data}catch(s){console.error("Error fetching permutas:",s)}},async getSubregions(){try{const s=await u.get("/api/subregions/list");this.subregions=s.data}catch(s){console.error("Error fetching subregions:",s)}},async getLocations(){try{const s=await u.get("/gerente/locations");this.locations=s.data}catch(s){console.error("Error fetching locations:",s)}},statusClass(s){switch(s.toLowerCase()){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},statusIcon(s){switch(s.toLowerCase()){case"approved":return"fa-solid fa-check";case"rejected":return"fa-solid fa-x";case"pending":return"fa-solid fa-spinner";default:return"fa-solid fa-question"}},openDetailModal(s){console.log("Opening detail modal for permuta ID:",s),this.selectedPermuta=this.permutas.find(r=>r.id===s),this.showDetailModal=!0},closeDetailModal(){console.log("Closing detail modal"),this.showDetailModal=!1,this.selectedPermuta=null},logout(){u.post("/logout").then(s=>{window.location.href="/login"}).catch(s=>{console.error("Error during logout:",s)})},goToPendingPermutas(){window.location.href="/gerente/permutas/pending"}},mounted(){this.getPermutas(),this.getSubregions(),this.getLocations()}},P={class:"grid grid-cols-2 gap-4 items-center border-b border-gray-200"},D={class:"font-bold text-sm text-black leading-tight"},F=e("p",{class:"text-sm"},"Gerente de Sala",-1),S={class:"flex items-center",style:{"margin-left":"auto"}},M=e("i",{class:"fa-solid fa-sign-out-alt mr-2"},null,-1),A=[M],E={class:"flex flex-row gap-2 bg-white shadow-md rounded-lg overflow-hidden p-2 items-center"},R={class:"flex-1 text-center text-xs"},T=e("span",{class:"font-bold"}," Aprobadas: ",-1),V={class:"flex-1 text-center text-xs text-black"},B=e("span",{class:"font-bold"},"Pendientes: ",-1),G={class:"flex-1 text-center"},Q=e("label",{class:"text-xs font-semibold mr-2"},"Mes:",-1),U=e("option",{value:"todos"},"todos",-1),N=e("option",{value:"enero"},"Ene",-1),z=e("option",{value:"febrero"},"Feb",-1),q=e("option",{value:"marzo"},"Mar",-1),J=e("option",{value:"abril"},"Abr",-1),O=e("option",{value:"mayo"},"May",-1),H=e("option",{value:"junio"},"Jun",-1),I=e("option",{value:"julio"},"Jul",-1),K=e("option",{value:"agosto"},"Ago",-1),W=e("option",{value:"septiembre"},"Sep",-1),X=e("option",{value:"octubre"},"Oct",-1),Y=e("option",{value:"noviembre"},"Nov",-1),Z=e("option",{value:"diciembre"},"Dic",-1),$=[U,N,z,q,J,O,H,I,K,W,X,Y,Z],ee={class:"px-2 flex justify-between items-center my-4"},te=e("h2",{class:"font-bold text-sm text-black leading-tight"}," Lista de Permutas ",-1),se={class:"absolute -bottom-1 -left-2 inline-block w-4 h-4 bg-red-500 text-white text-xxs font-bold rounded-full text-center"},oe={class:"px-2"},re={class:"relative text-gray-600 w-full"},ne={class:"flex gap-2 my-4 px-2"},ie={class:"flex gap-2 my-4 px-2"},le=e("option",{value:""},"T. Localidades",-1),de=["value"],ae={class:"p-2 overflow-hidden shadow-xl sm:rounded-lg"},ce={class:"flex flex-col gap-4"},ue={class:"w-3/5 border-r border-gray-200"},ge={class:"p-4"},_e={class:"text-sm font-semibold"},he=e("i",{class:"fa-solid fa-user"},null,-1),fe={class:"text-xs flex items-center justify-between"},pe={class:"bg-gray-100 rounded pt-1 pl-1 pb-1 pr-2 flex-3/4"},xe=e("i",{class:"fa-brands fa-square-letterboxd"},null,-1),be={class:"flex items-center mt-2 pl-2"},ve={class:"flex flex-col items-center"},we={class:"flex flex-col items-center"},me={class:"flex flex-col items-center"},ye={class:"flex justify-between mt-2"},Ce={class:"text-xs font-medium text-gray-500"},ke=e("br",null,null,-1),Le={key:0},je={class:"text-xs font-medium text-gray-500 pr-5"},Pe=e("br",null,null,-1),De={key:0},Fe={class:"text-xs font-medium text-gray-500"},Se=e("br",null,null,-1),Me={key:0},Ae={class:"w-2/5 text-left"},Ee={class:"pb-2 px-4 text-left pt-2"},Re={class:"text-sm text-black font-bold"},Te={class:"text-xs mt-1 font-medium text-gray-500"},Ve={class:"text-xs font-medium text-gray-500 mt-4"},Be=["onClick"];function Ge(s,r,Qe,Ue,o,l){const w=h("PermutaDetails"),m=h("GuestLayout");return d(),f(m,{title:"Permutas | EDF"},{header:p(()=>[e("div",P,[e("div",null,[e("h2",D," Â¡Hola, "+n(s.$page.props.auth.user.name)+" ! ",1),F]),e("div",S,[e("button",{onClick:r[0]||(r[0]=(...t)=>l.logout&&l.logout(...t)),class:"absolute top-2 right-0 ml-4 flex items-center text-sm font-bold text-red-600"},A)])])]),default:p(()=>[e("div",E,[e("div",R,[T,a(" "+n(l.approvedCount),1)]),e("div",V,[B,a(" "+n(l.pendingCount),1)]),e("div",G,[Q,_(e("select",{"onUpdate:modelValue":r[1]||(r[1]=t=>o.selectedMonth=t),class:"border border-gray-300 rounded-md text-xs p-1 px-2"},$,512),[[x,o.selectedMonth]])])]),e("div",ee,[te,e("button",{onClick:r[2]||(r[2]=(...t)=>l.goToPendingPermutas&&l.goToPendingPermutas(...t)),class:"relative border border-black text-black font-semibold px-4 py-1 rounded ml-4 text-xs"},[a(" Permutas por aprobar "),e("span",se,n(l.pendingCount),1)])]),e("div",oe,[e("div",re,[_(e("input",{class:"border-2 border-gray-300 bg-white h-10 px-5 pr-16 rounded-lg text-sm focus:outline-none w-full",type:"search",name:"search",placeholder:"Buscar","onUpdate:modelValue":r[3]||(r[3]=t=>o.searchQuery=t)},null,512),[[k,o.searchQuery]])])]),e("div",ne,[e("button",{class:i(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="todos","bg-white text-black":o.selectedFilter!=="todos"}]),onClick:r[4]||(r[4]=t=>o.selectedFilter="todos")},"Todos",2),e("button",{class:i(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="approved","bg-white text-black":o.selectedFilter!=="approved"}]),onClick:r[5]||(r[5]=t=>o.selectedFilter="approved")},"Aprobadas",2),e("button",{class:i(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="rejected","bg-white text-black":o.selectedFilter!=="rejected"}]),onClick:r[6]||(r[6]=t=>o.selectedFilter="rejected")},"Rechazadas",2),e("button",{class:i(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="pending","bg-white text-black":o.selectedFilter!=="pending"}]),onClick:r[7]||(r[7]=t=>o.selectedFilter="pending")},"Pendientes",2)]),e("div",ie,[_(e("select",{"onUpdate:modelValue":r[8]||(r[8]=t=>o.selectedLocation=t),class:"form-select mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},[le,(d(!0),c(v,null,b(o.locations,t=>(d(),c("option",{key:t.id,value:t.name},n(t.name),9,de))),128))],512),[[x,o.selectedLocation]])]),e("div",ae,[e("div",ce,[(d(!0),c(v,null,b(l.filteredPermutas,t=>(d(),c("div",{key:t.id,class:"bg-white shadow-md rounded-lg overflow-hidden flex flex-row"},[e("div",ue,[e("div",ge,[e("div",_e,[he,a(" "+n(t.cod_cliente)+" - "+n(t.location.name),1)]),e("div",fe,[e("div",pe,[xe,a(" "+n(t.volume)+" CU ",1)])]),e("div",be,[e("div",ve,[e("div",{class:i({"w-8 h-8 flex items-center justify-center rounded-full bg-green-500":t.supervisor_status==="Approved","w-8 h-8 flex items-center justify-center rounded-full bg-red-500":t.supervisor_status==="Rejected","w-8 h-8 flex items-center justify-center rounded-full bg-gray-300":t.supervisor_status==="Pending"})},[e("i",{class:i({"fa-solid fa-check text-white":t.supervisor_status==="Approved","fa-solid fa-times text-white":t.supervisor_status==="Rejected","fa-solid fa-clock text-gray-400":t.supervisor_status==="Pending"})},null,2)],2)]),e("div",{class:i({"h-1 w-16 bg-green-500":t.supervisor_status==="Approved","h-1 w-16 bg-red-500":t.supervisor_status==="Rejected","h-1 w-16 bg-gray-300":t.supervisor_status==="Pending"})},null,2),e("div",we,[e("div",{class:i({"w-8 h-8 flex items-center justify-center rounded-full bg-green-500":t.gerente_status==="Approved","w-8 h-8 flex items-center justify-center rounded-full bg-red-500":t.gerente_status==="Rejected","w-8 h-8 flex items-center justify-center rounded-full bg-gray-300":t.gerente_status==="Pending"})},[e("i",{class:i({"fa-solid fa-check text-white":t.gerente_status==="Approved","fa-solid fa-times text-white":t.gerente_status==="Rejected","fa-solid fa-clock text-gray-400":t.gerente_status==="Pending"})},null,2)],2)]),e("div",{class:i({"h-1 w-16 bg-green-500":t.gerente_status==="Approved","h-1 w-16 bg-red-500":t.gerente_status==="Rejected","h-1 w-16 bg-gray-300":t.gerente_status==="Pending"})},null,2),e("div",me,[e("div",{class:i({"w-8 h-8 flex items-center justify-center rounded-full bg-green-500":t.trade_status==="Approved","w-8 h-8 flex items-center justify-center rounded-full bg-red-500":t.trade_status==="Rejected","w-8 h-8 flex items-center justify-center rounded-full bg-gray-300":t.trade_status==="Pending"})},[e("i",{class:i({"fa-solid fa-check text-white":t.trade_status==="Approved","fa-solid fa-times text-white":t.trade_status==="Rejected","fa-solid fa-clock text-gray-400":t.trade_status==="Pending"})},null,2)],2)])]),e("div",ye,[e("div",Ce,[a("Supervisor "),ke,t.supervisor_approved_at?(d(),c("span",Le,n(new Date(t.supervisor_approved_at).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"2-digit"})),1)):g("",!0)]),e("div",je,[a("Gerente "),Pe,t.gerente_approved_at?(d(),c("span",De,n(new Date(t.gerente_approved_at).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"2-digit"})),1)):g("",!0)]),e("div",Fe,[a("Trade "),Se,t.trade_approved_at?(d(),c("span",Me,n(new Date(t.trade_approved_at).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"2-digit"})),1)):g("",!0)])])])]),e("div",Ae,[e("div",Ee,[e("div",Re," Ruta: "+n(t.route),1),e("div",Te,n(t.condition)+" - "+n(t.doors_to_negotiate)+" "+n(t.doors_to_negotiate===1?"Puerta":"Puertas"),1),e("div",Ve,[e("button",{class:"bg-red-500 text-white font-bold py-1 px-2 rounded-md w-full",onClick:Ne=>l.openDetailModal(t.id)},"Ver Detalles",8,Be)])])])]))),128))])]),o.showDetailModal?(d(),f(w,{key:0,show:o.showDetailModal,permuta:o.selectedPermuta,id:`Permuta${o.selectedPermuta.id}`,onClose:l.closeDetailModal},null,8,["show","permuta","id","onClose"])):g("",!0)]),_:1})}const Ye=L(j,[["render",Ge]]);export{Ye as default};
