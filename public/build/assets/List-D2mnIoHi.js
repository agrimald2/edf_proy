import{_ as b}from"./GuestLayout-qqQ-g1vu.js";import f from"./PermutaItem-6OD66wu3.js";import{s as _,i as u,o as a,c as p,w as g,a as e,g as i,t as d,k as h,A as v,v as w,n as l,e as y,h as k,F as P}from"./app-BInITGe7.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Banner-X-QmM4lA.js";import"./PermutaDetails-Cdw875jM.js";import"./PermutaRejectReasonModal-mS5Fft4o.js";import"./PermutaApproveConfirmationModal-CZ9e_A4q.js";import"./PermutaApprovedModal-D8IrpgF_.js";import"./PermutaRejectedModal-BzkP_4tj.js";const F={components:{GuestLayout:b,PermutaItem:f},props:{mesa:{type:String},haveAvailableLimit:{type:Boolean}},data(){return{todaysDate:new Date().toLocaleDateString("es-ES",{weekday:"short",year:"numeric",month:"short",day:"numeric"}).replace(/^\w/,t=>t.toUpperCase()),selectedFilter:"todos",selectedMonth:new Date().toLocaleString("es-ES",{month:"long"}).toLowerCase(),permutas:[],searchQuery:"",showDetailModal:!1,selectedPermuta:null,showAddPermutaModal:!1}},computed:{filteredPermutas(){return this.permutas.filter(t=>this.selectedFilter==="todos"?!0:this.selectedFilter==="approved"?t.trade_status.toLowerCase()==="approved":this.selectedFilter==="rejected"?t.trade_status.toLowerCase()==="rejected"||t.supervisor_status.toLowerCase()==="rejected"||t.gerente_status.toLowerCase()==="rejected":this.selectedFilter==="pending"?t.trade_status.toLowerCase()==="pending"&&t.supervisor_status.toLowerCase()!=="rejected"&&t.gerente_status.toLowerCase()!=="rejected":t.gerente_status.toLowerCase()===this.selectedFilter).filter(t=>{if(this.selectedMonth!=="todos"){const s={enero:0,febrero:1,marzo:2,abril:3,mayo:4,junio:5,julio:6,agosto:7,septiembre:8,octubre:9,noviembre:10,diciembre:11};if(new Date(t.created_at).getMonth()!==s[this.selectedMonth])return!1}return t.cod_cliente.includes(this.searchQuery)||t.location.name.includes(this.searchQuery)})},sortedPermutas(){return this.filteredPermutas.sort((t,s)=>t.supervisor_status==="Pending"&&s.supervisor_status!=="Pending"?-1:t.supervisor_status!=="Pending"&&s.supervisor_status==="Pending"?1:0)},approvedCount(){return this.permutas.filter(t=>t.trade_status.toLowerCase()==="approved").length},pendingCount(){return this.permutas.filter(t=>t.supervisor_status.toLowerCase()==="pending").length}},methods:{async getPermutas(){try{const t=await _.get(`/api/supervisor/${this.mesa}/permutas`);this.permutas=t.data}catch(t){console.error("Error fetching permutas:",t)}},statusClass(t){switch(t.toLowerCase()){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},statusIcon(t){switch(t.toLowerCase()){case"approved":return"fa-solid fa-check";case"rejected":return"fa-solid fa-x";case"pending":return"fa-solid fa-spinner";default:return"fa-solid fa-question"}},openDetailModal(t){this.selectedPermuta=t,this.showDetailModal=!0},goBack(){window.location.href=`/mesa/${this.mesa}/info`},goToPendingPermutas(){window.location.href=`/supervisor/${this.mesa}/dashboard/permutas/pending`}},mounted(){this.getPermutas()}},L={class:"flex items-center justify-between px-4 py-2 bg-white shadow-md border-b border-gray-200"},M=e("i",{class:"fa-solid fa-chevron-left font-bold"},null,-1),D=[M],j=e("h3",{class:"text-center text-sm font-bold text-gray-800 flex-1"},"Permutas",-1),z={class:"flex flex-row gap-2 bg-white shadow-md rounded-lg overflow-hidden p-2 items-center"},B={class:"flex-1 text-center text-xs"},S=e("span",{class:"font-bold"}," Aprobadas: ",-1),A={class:"flex-1 text-center text-xs text-black"},E=e("span",{class:"font-bold"},"Pendientes: ",-1),T={class:"flex-1 text-center"},Q=e("label",{class:"text-xs font-semibold mr-2"},"Mes:",-1),I=e("option",{value:"todos"},"todos",-1),V=e("option",{value:"enero"},"Ene",-1),G=e("option",{value:"febrero"},"Feb",-1),N=e("option",{value:"marzo"},"Mar",-1),O=e("option",{value:"abril"},"Abr",-1),U=e("option",{value:"mayo"},"May",-1),J=e("option",{value:"junio"},"Jun",-1),q=e("option",{value:"julio"},"Jul",-1),R=e("option",{value:"agosto"},"Ago",-1),H=e("option",{value:"septiembre"},"Sep",-1),K=e("option",{value:"octubre"},"Oct",-1),W=e("option",{value:"noviembre"},"Nov",-1),X=e("option",{value:"diciembre"},"Dic",-1),Y=[I,V,G,N,O,U,J,q,R,H,K,W,X],Z={class:"px-2 flex justify-between items-center my-4"},$=e("h2",{class:"font-bold text-sm text-black leading-tight"}," Lista de Permutas ",-1),ee={class:"absolute -bottom-1 -left-2 inline-block w-4 h-4 bg-red-500 text-white text-xxs font-bold rounded-full text-center"},te={class:"px-2"},se={class:"relative text-gray-600 w-full"},oe={class:"flex gap-1 my-2 px-1 overflow-x-auto no-scrollbar"},re={class:"p-2 overflow-hidden shadow-xl sm:rounded-lg"},ne={class:"flex flex-col gap-4"};function le(t,s,c,ae,o,n){const m=u("PermutaItem"),x=u("GuestLayout");return a(),p(x,{title:"Permutas | EDF"},{default:g(()=>[e("div",L,[e("button",{onClick:s[0]||(s[0]=r=>n.goBack()),class:"text-black text-sm hover:text-gray-800"},D),j]),e("div",z,[e("div",B,[S,i(" "+d(n.approvedCount),1)]),e("div",A,[E,i(" "+d(n.pendingCount),1)]),e("div",T,[Q,h(e("select",{"onUpdate:modelValue":s[1]||(s[1]=r=>o.selectedMonth=r),class:"border border-gray-300 rounded-md text-xs p-1 px-2"},Y,512),[[v,o.selectedMonth]])])]),e("div",Z,[$,e("button",{onClick:s[2]||(s[2]=(...r)=>n.goToPendingPermutas&&n.goToPendingPermutas(...r)),class:"relative border border-black text-black font-semibold px-4 py-1 rounded ml-4 text-xs"},[i(" Permutas por aprobar "),e("span",ee,d(n.pendingCount),1)])]),e("div",te,[e("div",se,[h(e("input",{class:"border-2 border-gray-300 bg-white h-10 px-5 pr-16 rounded-lg text-sm focus:outline-none w-full",type:"search",name:"search",placeholder:"Buscar","onUpdate:modelValue":s[3]||(s[3]=r=>o.searchQuery=r)},null,512),[[w,o.searchQuery]])])]),e("div",oe,[e("button",{class:l(["px-1 py0.5 text-xxs rounded-full border-black border",{"bg-black text-white":o.selectedFilter==="todos","bg-white text-black":o.selectedFilter!=="todos"}]),onClick:s[4]||(s[4]=r=>o.selectedFilter="todos"),style:{"font-size":"12px"}},"Todos",2),e("button",{class:l(["px-1 py-0.5 text-xxs rounded-full border-black border",{"bg-black text-white":o.selectedFilter==="approved","bg-white text-black":o.selectedFilter!=="approved"}]),onClick:s[5]||(s[5]=r=>o.selectedFilter="approved"),style:{"font-size":"12px"}},"Aprobadas",2),e("button",{class:l(["px-1 py-0.5 text-xxs rounded-full border-black border",{"bg-black text-white":o.selectedFilter==="rejected","bg-white text-black":o.selectedFilter!=="rejected"}]),onClick:s[6]||(s[6]=r=>o.selectedFilter="rejected"),style:{"font-size":"12px"}},"Rechazadas",2),e("button",{class:l(["px-1 py-0.5 text-xxs rounded-full border-black border",{"bg-black text-white":o.selectedFilter==="pending","bg-white text-black":o.selectedFilter!=="pending"}]),onClick:s[7]||(s[7]=r=>o.selectedFilter="pending"),style:{"font-size":"12px"}},"Pendientes",2)]),e("div",re,[e("div",ne,[(a(!0),y(P,null,k(n.sortedPermutas,r=>(a(),p(m,{key:r.id,permuta:r,showDetailModal:o.showDetailModal,selectedPermuta:o.selectedPermuta,sv:c.mesa,onOpenDetailModal:n.openDetailModal},null,8,["permuta","showDetailModal","selectedPermuta","sv","onOpenDetailModal"]))),128))])])]),_:1})}const _e=C(F,[["render",le]]);export{_e as default};
