import{_ as w}from"./GuestLayout-DNsTmEni.js";import y from"./PermutaDetails-Dfz5XP6s.js";import{j as p,l as h,o as d,c as m,w as _,a as e,t as n,g as i,m as u,y as b,s as k,n as a,e as c,h as g,F as f,f as C}from"./app-C58ATCsl.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Banner-CdfeB5GC.js";const D={components:{GuestLayout:w,PermutaDetails:y},props:["supervisor"],data(){return{todaysDate:new Date().toLocaleDateString("es-ES",{weekday:"short",year:"numeric",month:"short",day:"numeric"}).replace(/^\w/,t=>t.toUpperCase()),selectedFilter:"todos",permutas:[],searchQuery:"",showDetailModal:!1,selectedPermuta:null}},computed:{filteredPermutas(){return this.permutas.filter(t=>this.selectedFilter==="todos"||t.gerente_status.toLowerCase()===this.selectedFilter).filter(t=>t.cod_cliente.includes(this.searchQuery)||t.location.includes(this.searchQuery))},approvedCount(){return this.permutas.filter(t=>t.gerente_status.toLowerCase()==="approved").length},pendingCount(){return this.permutas.filter(t=>t.gerente_status.toLowerCase()==="pending").length}},methods:{async getPermutas(){try{const t=await p.get("/api/gerente/permutas");this.permutas=t.data}catch(t){console.error("Error fetching permutas:",t)}},statusClass(t){switch(t.toLowerCase()){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},statusIcon(t){switch(t.toLowerCase()){case"approved":return"fa-solid fa-check";case"rejected":return"fa-solid fa-x";case"pending":return"fa-solid fa-spinner";default:return"fa-solid fa-question"}},openDetailModal(t){console.log("Opening detail modal for permuta ID:",t),this.selectedPermuta=this.permutas.find(o=>o.id===t),this.showDetailModal=!0},closeDetailModal(){console.log("Closing detail modal"),this.showDetailModal=!1,this.selectedPermuta=null},logout(){p.post("/logout").then(t=>{window.location.href="/login"}).catch(t=>{console.error("Error during logout:",t)})}},mounted(){this.getPermutas()}},F={class:"grid grid-cols-2 gap-4 items-center border-b border-gray-200"},M={class:"font-bold text-sm text-black leading-tight"},L=e("p",{class:"text-sm"},"Gerente de Sala",-1),j={class:"flex items-center",style:{"margin-left":"auto"}},V=e("i",{class:"fa-solid fa-sign-out-alt mr-2"},null,-1),E=[V],S={class:"flex flex-row gap-2 bg-white shadow-md rounded-lg overflow-hidden p-2 items-center"},T={class:"flex-1 text-center text-xs"},B=e("span",{class:"font-bold"}," Aprobadas: ",-1),Q={class:"flex-1 text-center text-xs text-black"},U=e("span",{class:"font-bold"},"Pendientes: ",-1),A={class:"flex-1 text-center"},G=e("label",{class:"text-xs font-semibold mr-2"},"Mes:",-1),N=e("option",{value:"todos"},"todos",-1),z=e("option",{value:"enero"},"Ene",-1),q=e("option",{value:"febrero"},"Feb",-1),I=e("option",{value:"marzo"},"Mar",-1),J=e("option",{value:"abril"},"Abr",-1),O=e("option",{value:"mayo"},"May",-1),R=e("option",{value:"junio"},"Jun",-1),H=e("option",{value:"julio"},"Jul",-1),K=e("option",{value:"agosto"},"Ago",-1),W=e("option",{value:"septiembre"},"Sep",-1),X=e("option",{value:"octubre"},"Oct",-1),Y=e("option",{value:"noviembre"},"Nov",-1),Z=e("option",{value:"diciembre"},"Dic",-1),$=[N,z,q,I,J,O,R,H,K,W,X,Y,Z],ee={class:"px-2 flex justify-between items-center my-4"},te=e("h2",{class:"font-bold text-sm text-black leading-tight"}," Lista de Permutas ",-1),se={class:"absolute -bottom-1 -left-2 inline-block w-4 h-4 bg-red-500 text-white text-xxs font-bold rounded-full text-center"},oe={class:"px-2"},le={class:"relative text-gray-600 w-full"},re={class:"flex gap-2 my-4 px-2"},ne={class:"flex gap-2 my-4 px-2"},de=e("option",{value:""},"T. Localidades",-1),ie=["value"],ae={class:"p-2 overflow-hidden shadow-xl sm:rounded-lg"},ce={class:"flex flex-col gap-4"},ue={class:"w-3/5 border-r border-gray-200"},pe={class:"p-4"},he={class:"text-sm font-semibold"},me=e("i",{class:"fa-solid fa-user"},null,-1),_e={class:"text-xs flex items-center justify-between"},be={class:"bg-gray-100 rounded pt-1 pl-1 pb-1 pr-2 flex-3/4"},ge=e("i",{class:"fa-brands fa-square-letterboxd"},null,-1),fe={class:"mt-2"},xe={class:"w-2/5 text-left"},ve={class:"pb-2 px-4 text-left pt-2"},we={class:"text-sm text-black font-bold"},ye={class:"text-xs font-medium text-gray-500 mt-2"},ke=["onClick"];function Ce(t,o,Pe,De,l,r){const x=h("PermutaDetails"),v=h("GuestLayout");return d(),m(v,{title:"Permutas | EDF"},{header:_(()=>[e("div",F,[e("div",null,[e("h2",M," ¡Hola, "+n(t.$page.props.auth.user.name)+" ! ",1),L]),e("div",j,[e("button",{onClick:o[0]||(o[0]=(...s)=>r.logout&&r.logout(...s)),class:"absolute top-2 right-0 ml-4 flex items-center text-sm font-bold text-red-600"},E)])])]),default:_(()=>[e("div",S,[e("div",T,[B,i(" "+n(r.approvedCount),1)]),e("div",Q,[U,i(" "+n(r.pendingCount),1)]),e("div",A,[G,u(e("select",{"onUpdate:modelValue":o[1]||(o[1]=s=>t.selectedMonth=s),class:"border border-gray-300 rounded-md text-xs p-1 px-2"},$,512),[[b,t.selectedMonth]])])]),e("div",ee,[te,e("button",{onClick:o[2]||(o[2]=(...s)=>t.goToPendingPermutas&&t.goToPendingPermutas(...s)),class:"relative border border-black text-black font-semibold px-4 py-1 rounded ml-4 text-xs"},[i(" Permutas por aprobar "),e("span",se,n(r.pendingCount),1)])]),e("div",oe,[e("div",le,[u(e("input",{class:"border-2 border-gray-300 bg-white h-10 px-5 pr-16 rounded-lg text-sm focus:outline-none w-full",type:"search",name:"search",placeholder:"Buscar","onUpdate:modelValue":o[3]||(o[3]=s=>l.searchQuery=s)},null,512),[[k,l.searchQuery]])])]),e("div",re,[e("button",{class:a(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":l.selectedFilter==="todos","bg-white text-black":l.selectedFilter!=="todos"}]),onClick:o[4]||(o[4]=s=>l.selectedFilter="todos")},"Todos",2),e("button",{class:a(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":l.selectedFilter==="approved","bg-white text-black":l.selectedFilter!=="approved"}]),onClick:o[5]||(o[5]=s=>l.selectedFilter="approved")},"Aprobadas",2),e("button",{class:a(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":l.selectedFilter==="rejected","bg-white text-black":l.selectedFilter!=="rejected"}]),onClick:o[6]||(o[6]=s=>l.selectedFilter="rejected")},"Rechazadas",2),e("button",{class:a(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":l.selectedFilter==="pending","bg-white text-black":l.selectedFilter!=="pending"}]),onClick:o[7]||(o[7]=s=>l.selectedFilter="pending")},"Pendientes",2)]),e("div",ne,[u(e("select",{"onUpdate:modelValue":o[8]||(o[8]=s=>t.selectedLocation=s),class:"form-select mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},[de,(d(!0),c(f,null,g(t.locations,s=>(d(),c("option",{key:s.id,value:s.name},n(s.name),9,ie))),128))],512),[[b,t.selectedLocation]])]),e("div",ae,[e("div",ce,[(d(!0),c(f,null,g(r.filteredPermutas,s=>(d(),c("div",{key:s.id,class:"bg-white shadow-md rounded-lg overflow-hidden flex flex-row"},[e("div",ue,[e("div",pe,[e("div",he,[me,i(" "+n(s.cod_cliente)+" - "+n(s.location.name),1)]),e("div",_e,[e("div",be,[ge,i(" "+n(s.volume)+" CU ",1)])]),e("div",fe,[e("span",{class:a([r.statusClass(s.gerente_status),"text-xs font-semibold mr-2 px-2.5 py-1 rounded"])},[e("i",{class:a(r.statusIcon(s.gerente_status))},null,2),i(" "+n(s.gerente_status),1)],2)])])]),e("div",xe,[e("div",ve,[e("div",we," Ruta: "+n(s.route),1),e("div",ye,[e("button",{class:"bg-red-500 text-white font-bold py-1 px-2 rounded-md w-full",onClick:Fe=>r.openDetailModal(s)},"Ver más",8,ke)])])])]))),128))])]),l.showDetailModal?(d(),m(x,{key:0,show:l.showDetailModal,permuta:l.selectedPermuta,id:`Permuta${l.selectedPermuta.id}`,onClose:r.closeDetailModal},null,8,["show","permuta","id","onClose"])):C("",!0)]),_:1})}const Se=P(D,[["render",Ce]]);export{Se as default};
