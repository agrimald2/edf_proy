import{_ as y}from"./GuestLayout-n9QUaYHi.js";import k from"./PermutaDetails-BYGJBEVf.js";import{s as u,i as f,o as l,c as m,w as C,a as e,g as c,t as n,k as p,A as h,v as L,n as d,e as a,h as _,F as g,f as F}from"./app-CYQM2K1X.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Banner-Boh43R_R.js";import"./PermutaRejectReasonModal-BEf7V1-C.js";import"./PermutaApproveConfirmationModal-CEYkxJxB.js";import"./PermutaApprovedModal-DosqFzyW.js";import"./PermutaRejectedModal-B0YPQdX3.js";const M={components:{GuestLayout:y,PermutaDetails:k},props:["supervisor"],data(){return{todaysDate:new Date().toLocaleDateString("es-ES",{weekday:"short",year:"numeric",month:"short",day:"numeric"}).replace(/^\w/,t=>t.toUpperCase()),selectedFilter:"todos",selectedMonth:"todos",selectedRegion:"",selectedLocation:"",permutas:[],regions:[],locations:[],searchQuery:"",showDetailModal:!1,selectedPermuta:null}},computed:{filteredPermutas(){return this.permutas.filter(t=>this.selectedFilter==="todos"?!0:this.selectedFilter==="approved"?t.trade_status.toLowerCase()==="approved":this.selectedFilter==="rejected"?t.trade_status.toLowerCase()==="rejected"||t.supervisor_status.toLowerCase()==="rejected"||t.gerente_status.toLowerCase()==="rejected":this.selectedFilter==="pending"?t.trade_status.toLowerCase()==="pending"&&t.supervisor_status.toLowerCase()!=="rejected"&&t.gerente_status.toLowerCase()!=="rejected":t.gerente_status.toLowerCase()===this.selectedFilter).filter(t=>{if(this.selectedMonth!=="todos"){const r={enero:0,febrero:1,marzo:2,abril:3,mayo:4,junio:5,julio:6,agosto:7,septiembre:8,octubre:9,noviembre:10,diciembre:11};if(new Date(t.created_at).getMonth()!==r[this.selectedMonth])return!1}return t.cod_cliente.includes(this.searchQuery)||t.location.name.includes(this.searchQuery)})},approvedCount(){return this.permutas.filter(t=>t.trade_status.toLowerCase()==="approved").length},pendingCount(){return this.permutas.filter(t=>t.trade_status.toLowerCase()==="pending").length}},methods:{async getPermutas(){try{const t=await u.get("/api/trade/permutas");this.permutas=t.data}catch(t){console.error("Error fetching permutas:",t)}},async getRegions(){try{const t=await u.get("/api/regions");this.regions=t.data}catch(t){console.error("Error fetching regions:",t)}},async getLocations(){try{const t=await u.get("/api/locations");this.locations=t.data}catch(t){console.error("Error fetching locations:",t)}},statusClass(t){switch(t.toLowerCase()){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},statusIcon(t){switch(t.toLowerCase()){case"approved":return"fa-solid fa-check";case"rejected":return"fa-solid fa-x";case"pending":return"fa-solid fa-spinner";default:return"fa-solid fa-question"}},openDetailModal(t){this.selectedPermuta=t,this.showDetailModal=!0},goBack(){window.location.href=`/mesa/${this.supervisor}/info`},logout(){u.post("/logout").then(t=>{window.location.href="/login"}).catch(t=>{console.error("Error during logout:",t)})}},mounted(){this.getPermutas(),this.getRegions(),this.getLocations()}},j=e("div",{class:"flex items-center justify-between px-4 py-2 bg-white shadow-md border-b border-gray-200"},[e("h3",{class:"text-center text-sm font-bold text-gray-800 flex-1"},"Hola Carla!")],-1),P={class:"flex flex-row gap-2 bg-white shadow-md rounded-lg overflow-hidden p-2 items-center"},E={class:"flex-1 text-center text-xs"},R=e("span",{class:"font-bold"}," Aprobadas: ",-1),V={class:"flex-1 text-center text-xs text-black"},A=e("span",{class:"font-bold"},"Pendientes: ",-1),B={class:"flex-1 text-center"},U=e("label",{class:"text-xs font-semibold mr-2"},"Mes:",-1),z=e("option",{selected:"",value:"todos"},"todos",-1),N=e("option",{value:"enero"},"Ene",-1),Q=e("option",{value:"febrero"},"Feb",-1),S=e("option",{value:"marzo"},"Mar",-1),T=e("option",{value:"abril"},"Abr",-1),G=e("option",{value:"mayo"},"May",-1),q=e("option",{value:"junio"},"Jun",-1),I=e("option",{value:"julio"},"Jul",-1),J=e("option",{value:"agosto"},"Ago",-1),H=e("option",{value:"septiembre"},"Sep",-1),O=e("option",{value:"octubre"},"Oct",-1),K=e("option",{value:"noviembre"},"Nov",-1),W=e("option",{value:"diciembre"},"Dic",-1),X=[z,N,Q,S,T,G,q,I,J,H,O,K,W],Y={class:"px-2"},Z={class:"relative mx-auto text-gray-600 w-full"},$=e("h2",{class:"font-bold text-sm text-black leading-tight pt-4 pb-2"}," Lista de Permutas ",-1),ee={class:"flex gap-2 my-4 px-2"},te={class:"flex gap-2 my-4 px-2"},se=e("option",{value:""},"Todas las Regiones",-1),oe=["value"],re=e("option",{value:""},"Todas las Localidades",-1),ne=["value"],le={class:"p-2 overflow-hidden shadow-xl sm:rounded-lg"},ie={class:"flex flex-col gap-4"},de={class:"w-3/5 border-r border-gray-200"},ae={class:"p-4"},ce={class:"text-sm font-semibold"},ue=e("i",{class:"fa-solid fa-user"},null,-1),pe={class:"text-xs flex items-center justify-between"},he={class:"bg-gray-100 rounded pt-1 pl-2 pb-1 pr-2 flex-3/4"},_e=e("i",{class:"fa-brands fa-square-letterboxd mr-2"},null,-1),ge={class:"flex-1/4 text-right"},fe={class:"mt-2"},me={class:"w-2/5 text-left"},be={class:"p-4 text-left"},xe={class:"text-sm text-black font-bold"},ve={class:"text-xs mt-1 font-medium text-gray-500"},we={class:"text-xs font-medium text-gray-500 mt-2"},ye=["onClick"];function ke(t,r,b,Ce,o,i){const x=f("PermutaDetails"),v=f("GuestLayout");return l(),m(v,{title:"Permutas | EDF"},{default:C(()=>[j,e("div",P,[e("div",E,[R,c(" "+n(i.approvedCount),1)]),e("div",V,[A,c(" "+n(i.pendingCount),1)]),e("div",B,[U,p(e("select",{"onUpdate:modelValue":r[0]||(r[0]=s=>o.selectedMonth=s),class:"border border-gray-300 rounded-md text-xs p-1 px-2"},X,512),[[h,o.selectedMonth]])])]),e("div",Y,[e("div",Z,[$,p(e("input",{class:"border-2 border-gray-300 bg-white h-10 px-5 pr-16 rounded-lg text-sm focus:outline-none w-full",type:"search",name:"search",placeholder:"Buscar","onUpdate:modelValue":r[1]||(r[1]=s=>o.searchQuery=s)},null,512),[[L,o.searchQuery]])])]),e("div",ee,[e("button",{class:d(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="todos","bg-white text-black":o.selectedFilter!=="todos"}]),onClick:r[2]||(r[2]=s=>o.selectedFilter="todos")},"Todos",2),e("button",{class:d(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="approved","bg-white text-black":o.selectedFilter!=="approved"}]),onClick:r[3]||(r[3]=s=>o.selectedFilter="approved")},"Aprobadas",2),e("button",{class:d(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="rejected","bg-white text-black":o.selectedFilter!=="rejected"}]),onClick:r[4]||(r[4]=s=>o.selectedFilter="rejected")},"Rechazadas",2),e("button",{class:d(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="pending","bg-white text-black":o.selectedFilter!=="pending"}]),onClick:r[5]||(r[5]=s=>o.selectedFilter="pending")},"Pendientes",2)]),e("div",te,[p(e("select",{"onUpdate:modelValue":r[6]||(r[6]=s=>o.selectedRegion=s),class:"form-select mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},[se,(l(!0),a(g,null,_(o.regions,s=>(l(),a("option",{key:s.id,value:s.name},n(s.name),9,oe))),128))],512),[[h,o.selectedRegion]]),p(e("select",{"onUpdate:modelValue":r[7]||(r[7]=s=>o.selectedLocation=s),class:"form-select mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},[re,(l(!0),a(g,null,_(o.locations,s=>(l(),a("option",{key:s.id,value:s.name},n(s.name),9,ne))),128))],512),[[h,o.selectedLocation]])]),e("div",le,[e("div",ie,[(l(!0),a(g,null,_(i.filteredPermutas,s=>(l(),a("div",{key:s.id,class:"bg-white shadow-md rounded-lg overflow-hidden flex"},[e("div",de,[e("div",ae,[e("div",ce,[ue,c(" "+n(s.cod_cliente)+" - "+n(s.location.name),1)]),e("div",pe,[e("div",he,[_e,c(" "+n(s.have_edf?"Cuenta con EDF":"No cuenta con EDF"),1)]),e("div",ge,n(s.volume)+" CU ",1)]),e("div",fe,[e("span",{class:d([i.statusClass(s.trade_status),"text-xs font-semibold mr-2 px-2.5 py-1 rounded"])},[e("i",{class:d(i.statusIcon(s.trade_status))},null,2),c(" "+n(s.trade_status==="Approved"?"Aprobada":s.trade_status==="Rejected"?"Rechazada":s.trade_status==="Pending"?"Pendiente":s.trade_status),1)],2)])])]),e("div",me,[e("div",be,[e("div",xe,n(s.subcanal),1),e("div",ve," Ruta: "+n(s.route),1),e("div",we,[e("button",{class:"bg-red-500 text-white font-bold py-1 px-2 rounded-md w-full",onClick:w=>i.openDetailModal(s)},"Ver mÃ¡s",8,ye)]),o.showDetailModal?(l(),m(x,{key:0,show:o.showDetailModal,permuta:o.selectedPermuta,onClose:r[8]||(r[8]=w=>o.showDetailModal=!1)},null,8,["show","permuta"])):F("",!0)])])]))),128))])])]),_:1})}const Ae=D(M,[["render",ke]]);export{Ae as default};
