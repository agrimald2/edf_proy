import p from"./PermutaSent-DseJI2Hy.js";import{i as f,o as n,e as r,a as e,t as m,f as h,j as g,m as a,A as d,z as u,F as _,h as v,n as b,b as w}from"./app-BJlxEXRB.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";const y={components:{PermutaSent:p},props:{show:{type:Boolean,default:!1}},data(){return{formData:{clientCode:"",volumeCU:"",location:"",route:"",subcanal:"",haveEdf:!1,doorsToNegotiate:"",condition:"",reason:""},reasons:[],sentPermutaViewModal:!1,errorMessage:"",isSubmitting:!1}},mounted(){fetch("/api/permuta-reasons").then(l=>l.json()).then(l=>{this.reasons=l}).catch(l=>{console.error("Error fetching reasons:",l)})},computed:{isFormComplete(){return this.formData.clientCode&&this.formData.volumeCU&&this.formData.location&&this.formData.route&&this.formData.haveEdf!==""&&this.formData.doorsToNegotiate&&this.formData.condition&&this.formData.reason}},methods:{closeModal(){this.$emit("close")},submitForm(){this.isFormComplete&&!this.isSubmitting?(this.isSubmitting=!0,fetch("/api/permutas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.formData)}).then(l=>{if(!l.ok)throw new Error("Network response was not ok");return l.json()}).then(l=>{console.log("Success:",l),this.showSentPermutaView()}).catch(l=>{console.error("Error:",l),this.errorMessage="Failed to submit permuta. Please try again."}).finally(()=>{this.isSubmitting=!1})):this.errorMessage="Please complete all fields before submitting."},showSentPermutaView(){this.sentPermutaViewModal=!0}}},x={class:"z-20 fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center"},C={key:0,class:"bg-white rounded-lg shadow-lg w-96 p-6 relative"},M=e("i",{class:"fa-solid fa-circle-xmark text-gray-500"},null,-1),S=[M],V=e("div",{class:"text-center mb-10 pt-6"},[e("h2",{class:"text-lg font-bold"},"Permutas"),e("p",null,"Ingresa los datos solicitados")],-1),k={key:0,class:"text-red-500 text-center mb-4"},F=e("p",{class:"font-semibold mb-2"},"Información del cliente",-1),P={class:"grid grid-cols-2 gap-4"},U={class:"grid grid-cols-2 gap-4"},N={class:"grid grid-cols-1 gap-4 mt-4"},E=e("p",{class:"font-semibold"},"EDF a solicitar",-1),T={class:"mt-4 mb-2"},j={class:"grid grid-cols-2 gap-2"},A={class:"flex items-center"},B={class:"w-full"},z=e("option",{value:"",disabled:"",selected:""},"¿Cueta con EDF?",-1),I=e("option",{value:"true"},"SI",-1),O=e("option",{value:"false"},"NO",-1),R=[z,I,O],L={class:"flex items-center"},J={class:"w-full"},q=e("option",{value:"",disabled:"",selected:""},"Condición",-1),G=e("option",{value:"Nuevo"},"Nuevo",-1),H=e("option",{value:"Repotenciado"},"Repotenciado",-1),K=[q,G,H],Q={class:"grid grid-cols-1 gap-4 mt-4"},W={class:"mt-4"},X={class:"w-full"},Y=e("option",{value:"",disabled:"",selected:""},"Motivo",-1),Z=["value"],$={class:"mt-2 pt-2"},ee=["disabled"],te={class:"mt-2 text-center bg-white border rounded-lg py-2 border-black font-medium"},oe={key:1,class:"bg-white rounded-lg shadow-lg w-96 p-6"};function se(l,o,le,ie,s,i){const c=f("PermutaSent");return n(),r("div",x,[s.sentPermutaViewModal?(n(),r("div",oe,[w(c,{onAccept:i.closeModal},null,8,["onAccept"])])):(n(),r("div",C,[e("button",{onClick:o[0]||(o[0]=(...t)=>i.closeModal&&i.closeModal(...t)),class:"absolute top-2 right-2 text-gray-500 hover:text-gray-700"},S),V,e("div",null,[s.errorMessage?(n(),r("div",k,m(s.errorMessage),1)):h("",!0),e("form",{class:"space-y-4",onSubmit:o[11]||(o[11]=g((...t)=>i.submitForm&&i.submitForm(...t),["prevent"]))},[F,e("div",P,[e("div",null,[a(e("input",{"onUpdate:modelValue":o[1]||(o[1]=t=>s.formData.clientCode=t),type:"text",placeholder:"Código de cliente",class:"w-full inputs_permutas"},null,512),[[d,s.formData.clientCode]])]),e("div",null,[a(e("input",{"onUpdate:modelValue":o[2]||(o[2]=t=>s.formData.volumeCU=t),type:"text",placeholder:"Volumen en CU",class:"w-full inputs_permutas"},null,512),[[d,s.formData.volumeCU]])])]),e("div",U,[e("div",null,[a(e("input",{"onUpdate:modelValue":o[3]||(o[3]=t=>s.formData.location=t),type:"text",placeholder:"Locación",class:"w-full inputs_permutas"},null,512),[[d,s.formData.location]])]),e("div",null,[a(e("input",{"onUpdate:modelValue":o[4]||(o[4]=t=>s.formData.route=t),type:"text",placeholder:"Ruta",class:"w-full inputs_permutas"},null,512),[[d,s.formData.route]])])]),e("div",N,[e("div",null,[a(e("input",{"onUpdate:modelValue":o[5]||(o[5]=t=>s.formData.subcanal=t),type:"text",placeholder:"Subcanal",class:"w-full inputs_permutas"},null,512),[[d,s.formData.subcanal]])])]),E,e("div",T,[e("div",j,[e("div",A,[e("div",B,[a(e("select",{"onUpdate:modelValue":o[6]||(o[6]=t=>s.formData.haveEdf=t),class:"w-full inputs_permutas"},R,512),[[u,s.formData.haveEdf]])])]),e("div",L,[e("div",J,[a(e("select",{"onUpdate:modelValue":o[7]||(o[7]=t=>s.formData.condition=t),class:"w-full inputs_permutas"},K,512),[[u,s.formData.condition]])])])])]),e("div",Q,[e("div",null,[a(e("input",{"onUpdate:modelValue":o[8]||(o[8]=t=>s.formData.doorsToNegotiate=t),type:"text",placeholder:"Puertas a negociar",class:"w-full inputs_permutas"},null,512),[[d,s.formData.doorsToNegotiate]])])]),e("div",W,[e("div",X,[a(e("select",{"onUpdate:modelValue":o[9]||(o[9]=t=>s.formData.reason=t),class:"w-full inputs_permutas"},[Y,(n(!0),r(_,null,v(s.reasons,t=>(n(),r("option",{key:t.id,value:t.name},m(t.name),9,Z))),128))],512),[[u,s.formData.reason]])])]),e("div",$,[e("button",{disabled:!i.isFormComplete||s.isSubmitting,onClick:o[10]||(o[10]=(...t)=>i.submitForm&&i.submitForm(...t)),class:b(["w-full py-3 font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-opacity-50",i.isFormComplete&&!s.isSubmitting?"bg-black text-white hover:bg-gray-800 focus:ring-gray-400":"bg-gray-300 text-gray-500 hover:bg-blue-700 focus:ring-blue-400"])}," Enviar permuta ",10,ee)])],32),e("div",te,[e("button",{onClick:o[12]||(o[12]=(...t)=>i.closeModal&&i.closeModal(...t)),class:"text-black hover:underline focus:outline-none rounded-full"},"Cerrar")])])]))])}const de=D(y,[["render",se]]);export{de as default};
