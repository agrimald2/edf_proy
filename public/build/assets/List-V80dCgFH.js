import{_ as y}from"./GuestLayout-DT6dEh_F.js";import k from"./PermutaDetails-DD7fiUFD.js";import{q as u,i as m,o as i,c as f,w as _,a as e,t as r,g as c,m as g,A as C,n as a,z as b,e as d,h,F as p,f as F}from"./app-B7LFm1id.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Banner-BQlN9yx6.js";import"./PermutaRejectReasonModal-DLPlkq-r.js";import"./PermutaApproveConfirmationModal-BcK5qk2T.js";import"./PermutaApprovedModal-DIcAT753.js";import"./PermutaRejectedModal-ESHyrzZW.js";const D={components:{GuestLayout:y,PermutaDetails:k},props:["supervisor"],data(){return{todaysDate:new Date().toLocaleDateString("es-ES",{weekday:"short",year:"numeric",month:"short",day:"numeric"}).replace(/^\w/,t=>t.toUpperCase()),selectedFilter:"todos",selectedSubregion:"",selectedLocation:"",permutas:[],searchQuery:"",showDetailModal:!1,selectedPermuta:null,subregions:[],locations:[]}},computed:{filteredPermutas(){return this.permutas.filter(t=>(this.selectedFilter==="todos"||t.gerente_status.toLowerCase()===this.selectedFilter)&&(this.selectedSubregion===""||t.location.subregion.name===this.selectedSubregion)&&(this.selectedLocation===""||t.location.name===this.selectedLocation)).filter(t=>t.cod_cliente.includes(this.searchQuery)||t.location.name.includes(this.searchQuery))},approvedCount(){return this.permutas.filter(t=>t.gerente_status.toLowerCase()==="approved").length},pendingCount(){return this.permutas.filter(t=>t.gerente_status.toLowerCase()==="pending").length}},methods:{async getPermutas(){try{const t=await u.get("/gerente/permutas");this.permutas=t.data}catch(t){console.error("Error fetching permutas:",t)}},async getSubregions(){try{const t=await u.get("/api/subregions/list");this.subregions=t.data}catch(t){console.error("Error fetching subregions:",t)}},async getLocations(){try{const t=await u.get("/api/location/list");this.locations=t.data}catch(t){console.error("Error fetching locations:",t)}},statusClass(t){switch(t.toLowerCase()){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},statusIcon(t){switch(t.toLowerCase()){case"approved":return"fa-solid fa-check";case"rejected":return"fa-solid fa-x";case"pending":return"fa-solid fa-spinner";default:return"fa-solid fa-question"}},openDetailModal(t){this.selectedPermuta=t,this.showDetailModal=!0},logout(){u.post("/logout").then(t=>{window.location.href="/login"}).catch(t=>{console.error("Error during logout:",t)})}},mounted(){this.getPermutas(),this.getSubregions(),this.getLocations()}},S={class:"grid grid-cols-2 gap-4 items-center"},P={class:"font-bold text-sm text-black leading-tight"},M=e("p",{class:"text-sm"},"Gerente de Sala",-1),E={class:"flex items-center",style:{"margin-left":"auto"}},V=e("span",{class:"text-xs font-bold"},"Frecuencia:",-1),j=e("select",{style:{"padding-right":"2rem"},class:"block mt-1 border-none rounded focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 text-sm"},[e("option",{value:"lunes"},"Lunes"),e("option",{value:"martes"},"Martes"),e("option",{value:"miércoles"},"Miércoles"),e("option",{value:"jueves"},"Jueves"),e("option",{value:"viernes"},"Viernes"),e("option",{value:"sábado"},"Sábado"),e("option",{value:"domingo"},"Domingo")],-1),B=e("i",{class:"fa-solid fa-sign-out-alt mr-2"},null,-1),Q=[B],T={class:"flex flex-col gap-4"},U={class:"bg-white shadow-md rounded-lg overflow-hidden flex"},G={class:"flex-1 border-r border-gray-200"},N={class:"p-4"},q=e("div",{class:"text-sm font-semibold"},[e("i",{class:"fa-solid fa-check-circle text-green-500"}),c(" Aprobadas ")],-1),z={class:"text-xs pt-2 pl-4"},A=e("span",{class:"font-bold"}," Cantidad: ",-1),R={class:"flex-1 text-left"},I={class:"p-4 text-left"},H=e("div",{class:"text-sm text-black font-bold"},[e("i",{class:"fa-solid fa-clock text-yellow-500"}),c(" Restantes ")],-1),J={class:"text-xs mt-1 font-medium text-gray-500"},K={class:"px-2"},O={class:"relative mx-auto text-gray-600 w-full"},W=e("h2",{class:"font-bold text-sm text-black leading-tight pt-4 pb-2"}," Lista de Permutas ",-1),X={class:"flex gap-2 my-4 px-2"},Y={class:"flex gap-2 my-4 px-2"},Z=e("option",{value:""},"T. Subregiones",-1),$=["value"],ee=e("option",{value:""},"T. Localidades",-1),te=["value"],se={class:"p-2 overflow-hidden shadow-xl sm:rounded-lg"},oe={class:"flex flex-col gap-4"},le={class:"w-3/5 border-r border-gray-200"},re={class:"p-4"},ne={class:"text-sm font-semibold"},ie=e("i",{class:"fa-solid fa-user"},null,-1),ae={class:"text-xs flex items-center justify-between"},de={class:"bg-gray-100 rounded pt-1 pl-2 pb-1 pr-2 flex-3/4"},ce=e("i",{class:"fa-brands fa-square-letterboxd mr-2"},null,-1),ue={class:"flex-1/4 text-right"},ge={class:"mt-2"},he={class:"w-2/5 text-left"},pe={class:"p-4 text-left"},me={class:"text-sm text-black font-bold"},fe={class:"text-xs mt-1 font-medium text-gray-500"},_e={class:"text-xs font-medium text-gray-500 mt-2"},be=["onClick"];function xe(t,l,ve,we,o,n){const x=m("PermutaDetails"),v=m("GuestLayout");return i(),f(v,{title:"Permutas | EDF"},{header:_(()=>[e("div",S,[e("div",null,[e("h2",P," ¡Hola, "+r(t.$page.props.auth.user.name)+"! ",1),M]),e("div",E,[V,j,e("button",{onClick:l[0]||(l[0]=(...s)=>n.logout&&n.logout(...s)),class:"absolute top-2 right-0 ml-4 flex items-center text-sm font-bold text-red-600"},Q)])])]),default:_(()=>[e("div",T,[e("div",U,[e("div",G,[e("div",N,[q,e("div",z,[A,c(" "+r(n.approvedCount),1)])])]),e("div",R,[e("div",I,[H,e("div",J," Cantidad: "+r(n.pendingCount),1)])])])]),e("div",K,[e("div",O,[W,g(e("input",{class:"border-2 border-gray-300 bg-white h-10 px-5 pr-16 rounded-lg text-sm focus:outline-none w-full",type:"search",name:"search",placeholder:"Buscar","onUpdate:modelValue":l[1]||(l[1]=s=>o.searchQuery=s)},null,512),[[C,o.searchQuery]])])]),e("div",X,[e("button",{class:a(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="todos","bg-white text-black":o.selectedFilter!=="todos"}]),onClick:l[2]||(l[2]=s=>o.selectedFilter="todos")},"Todos",2),e("button",{class:a(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="approved","bg-white text-black":o.selectedFilter!=="approved"}]),onClick:l[3]||(l[3]=s=>o.selectedFilter="approved")},"Aprobadas",2),e("button",{class:a(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="rejected","bg-white text-black":o.selectedFilter!=="rejected"}]),onClick:l[4]||(l[4]=s=>o.selectedFilter="rejected")},"Rechazadas",2),e("button",{class:a(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="pending","bg-white text-black":o.selectedFilter!=="pending"}]),onClick:l[5]||(l[5]=s=>o.selectedFilter="pending")},"Pendientes",2)]),e("div",Y,[g(e("select",{"onUpdate:modelValue":l[6]||(l[6]=s=>o.selectedSubregion=s),class:"form-select mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},[Z,(i(!0),d(p,null,h(o.subregions,s=>(i(),d("option",{key:s.id,value:s.name},r(s.name),9,$))),128))],512),[[b,o.selectedSubregion]]),g(e("select",{"onUpdate:modelValue":l[7]||(l[7]=s=>o.selectedLocation=s),class:"form-select mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},[ee,(i(!0),d(p,null,h(o.locations,s=>(i(),d("option",{key:s.id,value:s.name},r(s.name),9,te))),128))],512),[[b,o.selectedLocation]])]),e("div",se,[e("div",oe,[(i(!0),d(p,null,h(n.filteredPermutas,s=>(i(),d("div",{key:s.id,class:"bg-white shadow-md rounded-lg overflow-hidden flex"},[e("div",le,[e("div",re,[e("div",ne,[ie,c(" "+r(s.cod_cliente)+" - "+r(s.location.name),1)]),e("div",ae,[e("div",de,[ce,c(" "+r(s.have_edf?"Cuenta con EDF":"No cuenta con EDF"),1)]),e("div",ue,r(s.volume)+" CU ",1)]),e("div",ge,[e("span",{class:a([n.statusClass(s.gerente_status),"text-xs font-semibold mr-2 px-2.5 py-1 rounded"])},[e("i",{class:a(n.statusIcon(s.gerente_status))},null,2),c(" "+r(s.gerente_status),1)],2)])])]),e("div",he,[e("div",pe,[e("div",me,r(s.subcanal),1),e("div",fe," Ruta: "+r(s.route),1),e("div",_e,[e("button",{class:"bg-red-500 text-white font-bold py-1 px-2 rounded-md w-full",onClick:w=>n.openDetailModal(s)},"Ver más",8,be)]),o.showDetailModal?(i(),f(x,{key:0,show:o.showDetailModal,permuta:o.selectedPermuta,onClose:l[8]||(l[8]=w=>o.showDetailModal=!1)},null,8,["show","permuta"])):F("",!0)])])]))),128))])])]),_:1})}const Ee=L(D,[["render",xe]]);export{Ee as default};
