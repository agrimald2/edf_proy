import{_ as m}from"./GuestLayout-Bor_W_Hm.js";import h from"./PendingPermutaItem-COYJI5o6.js";import{j as f,l as d,o as r,c as l,w as g,a as t,e as n,F as _,h as w}from"./app-Bt3dd_q1.js";import{_ as v}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Banner-BxaLIWzN.js";import"./PermutaDetails-ftfqWVwi.js";import"./PermutaRejectReasonModal-CHMcptdZ.js";import"./PermutaApproveConfirmationModal-DPsgv9Fy.js";import"./PermutaApprovedModal-DBsA_RaO.js";import"./PermutaRejectedModal-DQbYTE0c.js";const y={components:{GuestLayout:m,PendingPermutaItem:h},props:{mesa:{type:String},haveAvailableLimit:{type:Boolean}},data(){return{todaysDate:new Date().toLocaleDateString("es-ES",{weekday:"short",year:"numeric",month:"short",day:"numeric"}).replace(/^\w/,e=>e.toUpperCase()),selectedFilter:"todos",permutas:[],searchQuery:"",showDetailModal:!1,selectedPermuta:null,showAddPermutaModal:!1}},computed:{filteredPermutas(){return this.permutas.filter(e=>this.selectedFilter==="todos"?!0:this.selectedFilter==="approved"?e.trade_status.toLowerCase()==="approved":this.selectedFilter==="rejected"?e.trade_status.toLowerCase()==="rejected"||e.supervisor_status.toLowerCase()==="rejected"||e.gerente_status.toLowerCase()==="rejected":this.selectedFilter==="pending"?e.trade_status.toLowerCase()==="pending"&&e.supervisor_status.toLowerCase()!=="rejected"&&e.gerente_status.toLowerCase()!=="rejected":e.gerente_status.toLowerCase()===this.selectedFilter).filter(e=>e.cod_cliente.includes(this.searchQuery)||e.location.name.includes(this.searchQuery))},sortedPermutas(){return this.filteredPermutas.sort((e,s)=>e.supervisor_status==="Pending"&&s.supervisor_status!=="Pending"?-1:e.supervisor_status!=="Pending"&&s.supervisor_status==="Pending"?1:0)},approvedCount(){return this.permutas.filter(e=>e.trade_status.toLowerCase()==="approved").length},pendingCount(){return this.permutas.filter(e=>e.trade_status.toLowerCase()==="pending"&&e.supervisor_status.toLowerCase()!=="rejected"&&e.gerente_status.toLowerCase()!=="rejected").length}},methods:{async getPermutas(){try{const e=await f.get(`/api/supervisor/${this.mesa}/permutas/pending`);this.permutas=e.data}catch(e){console.error("Error fetching permutas:",e)}},statusClass(e){switch(e.toLowerCase()){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},statusIcon(e){switch(e.toLowerCase()){case"approved":return"fa-solid fa-check";case"rejected":return"fa-solid fa-x";case"pending":return"fa-solid fa-spinner";default:return"fa-solid fa-question"}},openDetailModal(e){this.selectedPermuta=e,this.showDetailModal=!0},goBack(){window.location.href=`/supervisor/${this.mesa}/dashboard/permutas`}},mounted(){this.getPermutas()}},x={class:"flex items-center justify-between px-4 py-2 bg-white shadow-md border-b border-gray-200"},P=t("i",{class:"fa-solid fa-chevron-left font-bold"},null,-1),C=[P],L=t("h3",{class:"text-center text-sm font-bold text-gray-800 flex-1"},"Permutas por aprobar ",-1),b=t("div",{class:"px-2 flex justify-between items-center my-4"},[t("h2",{class:"font-bold text-sm text-black leading-tight"}," Lista de Permutas ")],-1),j={class:"p-2 overflow-hidden shadow-xl sm:rounded-lg"},k={key:0,class:"text-center text-gray-500"},D={key:1,class:"flex flex-col gap-4"};function M(e,s,u,F,i,a){const c=d("PendingPermutaItem"),p=d("GuestLayout");return r(),l(p,{title:"Permutas | EDF"},{default:g(()=>[t("div",x,[t("button",{onClick:s[0]||(s[0]=o=>a.goBack()),class:"text-black text-sm hover:text-gray-800"},C),L]),b,t("div",j,[a.sortedPermutas.length===0?(r(),n("div",k," No hay permutas por aprobar. ")):(r(),n("div",D,[(r(!0),n(_,null,w(a.sortedPermutas,o=>(r(),l(c,{key:o.id,permuta:o,showDetailModal:i.showDetailModal,selectedPermuta:i.selectedPermuta,sv:u.mesa,onOpenDetailModal:a.openDetailModal},null,8,["permuta","showDetailModal","selectedPermuta","sv","onOpenDetailModal"]))),128))]))])]),_:1})}const U=v(y,[["render",M]]);export{U as default};
