import{_ as x}from"./GuestLayout-DIcUYv4m.js";import v from"./PermutaDetails-QtDRTOkz.js";import{q as m,i as u,o as n,c as p,w as _,a as e,t as l,g as a,m as w,A as y,n as d,e as h,h as k,f as C,F as P}from"./app-Cc-weMfv.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Banner-BGfCHkNP.js";import"./PermutaRejectReasonModal-BfwpxbCK.js";import"./PermutaApproveConfirmationModal-7re8t8ew.js";import"./PermutaApprovedModal-2ZYToDa7.js";import"./PermutaRejectedModal-DB5mUlQb.js";const F={components:{GuestLayout:x,PermutaDetails:v},props:{mesa:{type:String},haveAvailableLimit:{type:Boolean}},data(){return{todaysDate:new Date().toLocaleDateString("es-ES",{weekday:"short",year:"numeric",month:"short",day:"numeric"}).replace(/^\w/,s=>s.toUpperCase()),selectedFilter:"todos",permutas:[],searchQuery:"",showDetailModal:!1,selectedPermuta:null,showAddPermutaModal:!1}},computed:{filteredPermutas(){return this.permutas.filter(s=>this.selectedFilter==="todos"?!0:this.selectedFilter==="approved"?s.trade_status.toLowerCase()==="approved":this.selectedFilter==="rejected"?s.trade_status.toLowerCase()==="rejected"||s.supervisor_status.toLowerCase()==="rejected"||s.gerente_status.toLowerCase()==="rejected":this.selectedFilter==="pending"?s.trade_status.toLowerCase()==="pending"&&s.supervisor_status.toLowerCase()!=="rejected"&&s.gerente_status.toLowerCase()!=="rejected":s.gerente_status.toLowerCase()===this.selectedFilter).filter(s=>s.cod_cliente.includes(this.searchQuery)||s.location.name.includes(this.searchQuery))},sortedPermutas(){return this.filteredPermutas.sort((s,r)=>s.supervisor_status==="Pending"&&r.supervisor_status!=="Pending"?-1:s.supervisor_status!=="Pending"&&r.supervisor_status==="Pending"?1:0)},approvedCount(){return this.permutas.filter(s=>s.trade_status.toLowerCase()==="approved").length},pendingCount(){return this.permutas.filter(s=>s.trade_status.toLowerCase()==="pending"&&s.supervisor_status.toLowerCase()!=="rejected"&&s.gerente_status.toLowerCase()!=="rejected").length}},methods:{async getPermutas(){try{const s=await m.get(`/api/supervisor/${this.mesa}/permutas`);this.permutas=s.data}catch(s){console.error("Error fetching permutas:",s)}},statusClass(s){switch(s.toLowerCase()){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},statusIcon(s){switch(s.toLowerCase()){case"approved":return"fa-solid fa-check";case"rejected":return"fa-solid fa-x";case"pending":return"fa-solid fa-spinner";default:return"fa-solid fa-question"}},openDetailModal(s){this.selectedPermuta=s,this.showDetailModal=!0}},mounted(){this.getPermutas()}},D={class:"grid grid-cols-2 gap-4 items-center"},j={class:"font-bold text-sm text-black leading-tight"},A=e("p",{class:"text-sm"},"Supervisor ",-1),M=e("div",{class:"flex items-center",style:{"margin-left":"auto"}},[e("span",{class:"text-xs font-bold"},"Frecuencia:"),e("select",{style:{"padding-right":"2rem"},class:"block mt-1 border-none rounded focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 text-sm"},[e("option",{value:"lunes"},"Lunes"),e("option",{value:"martes"},"Martes"),e("option",{value:"miércoles"},"Miércoles"),e("option",{value:"jueves"},"Jueves"),e("option",{value:"viernes"},"Viernes"),e("option",{value:"sábado"},"Sábado"),e("option",{value:"domingo"},"Domingo")])],-1),R={class:"flex flex-col gap-4"},S={class:"bg-white shadow-md rounded-lg overflow-hidden flex"},B={class:"flex-1 border-r border-gray-200"},E={class:"p-4"},G=e("div",{class:"text-sm font-semibold"},[e("i",{class:"fa-solid fa-check-circle text-green-500"}),a(" Aprobadas ")],-1),T={class:"text-xs pt-2 pl-4"},V=e("span",{class:"font-bold"}," Cantidad: ",-1),z={class:"flex-1 text-left"},Q={class:"p-4 text-left"},N=e("div",{class:"text-sm text-black font-bold"},[e("i",{class:"fa-solid fa-clock text-yellow-500"}),a(" Restantes ")],-1),q={class:"text-xs mt-1 font-medium text-gray-500"},U={class:"px-2 my-2"},I=e("i",{class:"fa-solid fa-plus mr-2"},null,-1),H={class:"px-2"},J={class:"relative mx-auto text-gray-600 w-full"},K=e("h2",{class:"font-bold text-sm text-black leading-tight pt-4 pb-2"}," Lista de Permutas ",-1),O={class:"flex gap-2 my-4 px-2"},W={class:"p-2 overflow-hidden shadow-xl sm:rounded-lg"},X={class:"flex flex-col gap-4"},Y={class:"w-full md:w-3/5 border-r border-gray-200"},Z={class:"p-4"},$={class:"text-sm font-semibold"},ee=e("i",{class:"fa-solid fa-user"},null,-1),te={class:"text-xs flex items-center justify-between"},se={class:"bg-gray-100 rounded pt-1 pl-2 pb-1 pr-2 flex-3/4"},oe=e("i",{class:"fa-brands fa-square-letterboxd mr-2"},null,-1),re={class:"flex-1/4 text-right"},le=e("hr",null,null,-1),de={class:"mt-2"},ae={class:"overflow-x-auto"},ie={class:"min-w-full bg-white"},ne={class:"w-full md:w-2/5 text-left"},ce={class:"pb-2 px-4 text-left"},ue={class:"text-sm text-black font-bold"},pe={class:"text-xs mt-1 font-medium text-gray-500"},_e={class:"text-xs font-medium text-gray-500 mt-4"},he=["onClick"];function ge(s,r,c,be,o,i){const g=u("PermutaDetails"),b=u("GuestLayout");return n(),p(b,{title:"Permutas | EDF"},{header:_(()=>[e("div",D,[e("div",null,[e("h2",j," ¡Hola! "+l(c.mesa),1),A]),M])]),default:_(()=>[e("div",R,[e("div",S,[e("div",B,[e("div",E,[G,e("div",T,[V,a(" "+l(i.approvedCount),1)])])]),e("div",z,[e("div",Q,[N,e("div",q," Cantidad: "+l(i.pendingCount),1)])])])]),e("div",U,[e("button",{onClick:r[0]||(r[0]=(...t)=>s.openAddPermutaModal&&s.openAddPermutaModal(...t)),class:"bg-black text-white px-4 py-1 rounded-lg shadow-lg flex-1 font-bold"},[I,a("Ingresar permuta ")])]),e("div",H,[e("div",J,[K,w(e("input",{class:"border-2 border-gray-300 bg-white h-10 px-5 pr-16 rounded-lg text-sm focus:outline-none w-full",type:"search",name:"search",placeholder:"Buscar","onUpdate:modelValue":r[1]||(r[1]=t=>o.searchQuery=t)},null,512),[[y,o.searchQuery]])])]),e("div",O,[e("button",{class:d(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="todos","bg-white text-black":o.selectedFilter!=="todos"}]),onClick:r[2]||(r[2]=t=>o.selectedFilter="todos")},"Todos",2),e("button",{class:d(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="approved","bg-white text-black":o.selectedFilter!=="approved"}]),onClick:r[3]||(r[3]=t=>o.selectedFilter="approved")},"Aprobadas",2),e("button",{class:d(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="rejected","bg-white text-black":o.selectedFilter!=="rejected"}]),onClick:r[4]||(r[4]=t=>o.selectedFilter="rejected")},"Rechazadas",2),e("button",{class:d(["px-3 py-1 text-sm rounded-full border-black border-2",{"bg-black text-white":o.selectedFilter==="pending","bg-white text-black":o.selectedFilter!=="pending"}]),onClick:r[5]||(r[5]=t=>o.selectedFilter="pending")},"Pendientes",2)]),e("div",W,[e("div",X,[(n(!0),h(P,null,k(i.sortedPermutas,t=>(n(),h("div",{key:t.id,class:"bg-white shadow-md rounded-lg overflow-hidden flex flex-col md:flex-row"},[e("div",Y,[e("div",Z,[e("div",$,[ee,a(" "+l(t.cod_cliente)+" - "+l(t.location.name),1)]),e("div",te,[e("div",se,[oe,a(" "+l(t.have_edf?"Cuenta con EDF":"No cuenta con EDF"),1)]),e("div",re,l(t.volume)+" CU ",1)]),le,e("div",de,[e("div",ae,[e("table",ie,[e("thead",null,[e("tr",null,[e("th",{class:d(["py-2 px-4 border-b border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",{"bg-gray-100":t.instance_status==="Supervisor"}])}," Supervisor",2),e("th",{class:d(["py-2 px-4 border-b border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",{"bg-gray-100":t.instance_status==="Gerente"}])}," Gerente ",2),e("th",{class:d(["py-2 px-4 border-b border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",{"bg-gray-100":t.instance_status==="Trade"}])}," Trade",2)])]),e("tbody",null,[e("tr",null,[e("td",{class:d(["py-2 px-4 border-b border-gray-200 text-sm",{"font-bold":t.instance_status==="Supervisor"}])},l(t.supervisor_status==="Pending"?"Pendiente":t.supervisor_status==="Rejected"?"Rechazado":t.supervisor_status==="Approved"?"Aprobado":t.supervisor_status),3),e("td",{class:d(["py-2 px-4 border-b border-gray-200 text-sm",{"font-bold":t.instance_status==="Gerente"}])},l(t.gerente_status==="Pending"?"Pendiente":t.gerente_status==="Rejected"?"Rechazado":t.gerente_status==="Approved"?"Aprobado":t.gerente_status),3),e("td",{class:d(["py-2 px-4 border-b border-gray-200 text-sm",{"font-bold":t.instance_status==="Trade"}])},l(t.trade_status==="Pending"?"Pendiente":t.trade_status==="Rejected"?"Rechazado":t.trade_status==="Approved"?"Aprobado":t.trade_status),3)])])])])])])]),e("div",ne,[e("div",ce,[e("div",ue,l(t.condition)+" - "+l(t.doors_to_negotiate)+" "+l(t.doors_to_negotiate===1?"Puerta":"Puertas"),1),e("div",pe," Ruta: "+l(t.route),1),e("div",_e,[e("button",{class:"bg-red-500 text-white font-bold py-1 px-2 rounded-md w-full",onClick:f=>i.openDetailModal(t)},"Ver más",8,he)]),o.showDetailModal?(n(),p(g,{key:0,show:o.showDetailModal,permuta:o.selectedPermuta,haveAvailableLimit:c.haveAvailableLimit,sv:c.mesa,onClose:r[6]||(r[6]=f=>o.showDetailModal=!1)},null,8,["show","permuta","haveAvailableLimit","sv"])):C("",!0)])])]))),128))])])]),_:1})}const Le=L(F,[["render",ge]]);export{Le as default};
