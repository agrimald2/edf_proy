import b from"./PermutaRejectReasonModal-FX9QFt1p.js";import j from"./PermutaApproveConfirmationModal-DoF7yJ2L.js";import x from"./PermutaApprovedModal-5k-m0P76.js";import R from"./PermutaRejectedModal-XWuq5CR0.js";import{_ as y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{l as m,o as r,e as i,a as e,t as u,f as d,F as f,h as v,c as h}from"./app-BHKn7OIF.js";const C={components:{PermutaRejectReasonModal:b,PermutaApproveConfirmationModal:j,PermutaApprovedModal:x,PermutaRejectedModal:R},props:{show:{type:Boolean,default:!1},permuta:{type:Object,required:!0},haveAvailableLimit:{type:Boolean,default:!0},sv:{type:String}},data(){return{formData:this.mapPermutaToFormData(this.permuta),formDataLabels:{clientCode:"Código de cliente",date:"Fecha de Permuta",volumeCU:"Volumen en CU",location:"Locación",route:"Ruta",subcanal:"Subcanal",status:"Estado",rejectedReason:"Motivo"},edfDataLabels:{condition:"Condición",doorsToNegotiate:"Puertas a negociar",reason:"Motivo",justification:"Justificación"},errorMessage:"",showDetails:!0,showRejectReasonModal:!1,showRejectedModal:!1,showApproveConfirmationModal:!1,showApprovedModal:!1}},mounted(){fetch("/api/permuta-reasons").then(o=>o.json()).then(o=>{this.reasons=o}).catch(o=>{console.error("Error fetching reasons:",o)})},methods:{mapPermutaToFormData(o){const t=["supervisor_status","gerente_status","trade_status"].find(p=>o[p].toLowerCase()==="rejected")?"Rejected":"Pending",l=o.supervisor_rejected_reason||o.gerente_rejected_reason||o.trade_rejected_reason||"";return{date:new Date(o.created_at).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),clientCode:o.cod_cliente,volumeCU:o.volume,location:o.location.name,route:o.route,subcanal:o.subcanal,haveEdf:o.have_edf,doorsToNegotiate:o.doors_to_negotiate,condition:o.condition,reason:o.reason,justification:o.justification,status:t,rejectedReason:l}},approvePermuta(){this.showDetails=!1,this.showApproveConfirmationModal=!0},rejectPermuta(){this.showDetails=!1,this.showRejectReasonModal=!0},detailsModal(){this.showDetails=!0,this.showRejectReasonModal=!1,this.showRejectedModal=!1,this.showApproveConfirmationModal=!1,this.showApprovedModal=!1},closeModal(){this.$emit("close"),this.detailsModal()}}},P={class:"z-20 fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-2 overflow-y-auto"},D={class:"bg-white rounded-lg shadow-lg max-w-md w-full p-4 relative"},A=e("i",{class:"fa-solid fa-circle-xmark text-gray-500"},null,-1),k=[A],S={key:0},L=e("div",{class:"text-center mb-4"},[e("h2",{class:"text-xl font-bold"},"Detalles de Permuta"),e("p",{class:"text-gray-600 text-sm"},"Revisa la información de la permuta")],-1),B={key:0,class:"text-red-500 text-center mb-2 text-sm"},E={class:"space-y-2"},F={class:"px-2 rounded-lg"},N={class:"grid grid-cols-2 text-sm"},T={class:"font-bold"},U={class:"text-right"},V=e("hr",null,null,-1),z={class:"px-2 pb-1 rounded-lg"},q=e("h3",{class:"font-bold mb-1 text-red-700 text-sm"},"EDF a solicitar",-1),J={class:"grid grid-cols-2 text-sm"},O={class:"font-bold"},G={class:"text-right"},H={key:1,class:"mt-6 flex justify-between"},I={class:"mt-2 text-center"};function K(o,t,l,p,s,n){const g=m("PermutaRejectReasonModal"),M=m("PermutaRejectedModal"),_=m("PermutaApproveConfirmationModal"),w=m("PermutaApprovedModal");return r(),i("div",P,[e("div",D,[e("button",{onClick:t[0]||(t[0]=(...a)=>n.closeModal&&n.closeModal(...a)),class:"absolute top-1 right-1 text-gray-500 hover:text-gray-700"},k),s.showDetails?(r(),i("div",S,[L,e("div",null,[s.errorMessage?(r(),i("div",B,u(s.errorMessage),1)):d("",!0),e("div",E,[e("div",F,[e("div",N,[(r(!0),i(f,null,v(s.formDataLabels,(a,c)=>(r(),i(f,{key:c},[e("p",null,[e("span",T,u(a)+":",1)]),e("p",U,u(s.formData[c]),1)],64))),128))])]),V,e("div",z,[q,e("div",J,[(r(!0),i(f,null,v(s.edfDataLabels,(a,c)=>(r(),i(f,{key:c},[e("p",null,[e("span",O,u(a)+":",1)]),e("p",G,u(s.formData[c]),1)],64))),128))])])]),l.permuta.supervisor_status==="Pending"?(r(),i("div",H,[e("button",{onClick:t[1]||(t[1]=(...a)=>n.approvePermuta&&n.approvePermuta(...a)),class:"w-1/2 py-1 font-medium rounded-md bg-green-500 text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-opacity-50 mr-2"}," Aprobar "),e("button",{onClick:t[2]||(t[2]=(...a)=>n.rejectPermuta&&n.rejectPermuta(...a)),class:"w-1/2 py-1 font-medium rounded-md bg-red-500 text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-opacity-50 ml-2"}," Rechazar ")])):d("",!0),e("div",I,[e("button",{onClick:t[3]||(t[3]=(...a)=>n.closeModal&&n.closeModal(...a)),class:"w-full bg-black text-white px-2 py-1 rounded-lg hover:bg-red-600 focus:outline-none text-sm"},"Cerrar")])])])):d("",!0),s.showRejectReasonModal?(r(),h(g,{key:1,"permuta-id":l.permuta.id,onShowDetailsModal:n.detailsModal,onShowRejectedModal:t[4]||(t[4]=a=>s.showRejectedModal=!0),onClose:t[5]||(t[5]=a=>s.showRejectReasonModal=!1)},null,8,["permuta-id","onShowDetailsModal"])):d("",!0),s.showRejectedModal?(r(),h(M,{key:2,"permuta-id":l.permuta.id,onClose:t[6]||(t[6]=a=>s.showRejectedModal=!1)},null,8,["permuta-id"])):d("",!0),s.showApproveConfirmationModal?(r(),h(_,{key:3,"permuta-id":l.permuta.id,sv:l.sv,onShowDetailsModal:n.detailsModal,onClose:t[7]||(t[7]=a=>s.showApproveConfirmationModal=!1),onShowApprovedModal:t[8]||(t[8]=a=>s.showApprovedModal=!0)},null,8,["permuta-id","sv","onShowDetailsModal"])):d("",!0),s.showApprovedModal?(r(),h(w,{key:4,"permuta-id":l.permuta.id,onClose:t[9]||(t[9]=a=>s.showApprovedModal=!1)},null,8,["permuta-id"])):d("",!0)])])}const ee=y(C,[["render",K]]);export{ee as default};
