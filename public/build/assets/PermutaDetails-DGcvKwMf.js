import g from"./PermutaRejectReasonModal-BSvYsBrH.js";import v from"./PermutaApproveConfirmationModal-HKvYpuPY.js";import M from"./PermutaApprovedModal-DmxLqzH4.js";import w from"./PermutaRejectedModal-BHg60NKh.js";import{_ as b}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{l as c,o as i,e as u,a as e,t as r,f as d,c as h}from"./app-DhCoEYep.js";const x={components:{PermutaRejectReasonModal:g,PermutaApproveConfirmationModal:v,PermutaApprovedModal:M,PermutaRejectedModal:w},props:{show:{type:Boolean,default:!1},permuta:{type:Object,required:!0},haveAvailableLimit:{type:Boolean,default:!0},sv:{type:String}},data(){return{formData:{date:new Date(this.permuta.created_at).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),clientCode:this.permuta.cod_cliente,volumeCU:this.permuta.volume,location:this.permuta.location.name,route:this.permuta.route,subcanal:this.permuta.subcanal,haveEdf:this.permuta.have_edf,doorsToNegotiate:this.permuta.doors_to_negotiate,condition:this.permuta.condition,reason:this.permuta.reason,justification:this.permuta.justification},reasons:[],sentPermutaViewModal:!1,errorMessage:"",isSubmitting:!1,showDetails:!0,showRejectReasonModal:!1,showRejectedModal:!1,showApproveConfirmationModal:!1,showApprovedModal:!1,approvedBy:"-"}},created(){this.fetchData()},watch:{"permuta.id":function(s,o){s!==o&&this.fetchData()}},methods:{fetchData(){this.fetchReasons(),this.fetchSupervisorName()},approvePermuta(){this.showDetails=!1,this.showApproveConfirmationModal=!0},rejectPermuta(){this.showDetails=!1,this.showRejectReasonModal=!0},detailsModal(){this.showDetails=!0,this.showRejectReasonModal=!1,this.showRejectedModal=!1,this.showApproveConfirmationModal=!1,this.showApprovedModal=!1},closeModal(){this.$emit("close"),this.detailsModal()},fetchReasons(){console.log("Llamada a fetchReasons"),console.log(this.permuta.id),fetch("/api/permuta-reasons").then(s=>{if(!s.ok)throw new Error("Error fetching reasons");return s.json()}).then(s=>{this._isDestroyed||(this.reasons=s)}).catch(s=>{console.error("Error fetching reasons:",s.message),this.errorMessage="Error fetching reasons."})},fetchSupervisorName(){console.log("Llamada a fetchSupervisorName"),fetch(`/api/supervisor/nameByMesa/${this.permuta.supervisor_approved_by}`).then(s=>{if(!s.ok)throw new Error("Error fetching supervisor name");return s.json()}).then(s=>{this._isDestroyed||(this.approvedBy=s.nombre_sv)}).catch(s=>{console.error("Error fetching approved by name:",s.message),this.errorMessage="Error fetching supervisor name."})}}},y={class:"z-20 fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-2 overflow-y-auto"},D={class:"bg-white rounded-lg shadow-lg max-w-md w-full p-4 relative"},R=e("i",{class:"fa-solid fa-circle-xmark text-gray-500"},null,-1),j=[R],C={key:0},P={class:"text-center mb-4"},A=e("h2",{class:"text-xl font-bold"},"Detalles de Permuta",-1),k={class:"text-gray-600 text-sm"},S={key:0,class:"text-red-500 text-center mb-2 text-sm"},E={class:"space-y-2"},B={class:"px-2 rounded-lg"},N={class:"grid grid-cols-2 text-sm"},L=e("p",null,[e("span",{class:"font-bold"},"C贸digo de cliente:")],-1),V={class:"text-right"},U=e("p",null,[e("span",{class:"font-bold"},"Fecha de Permuta:")],-1),z={class:"text-right"},F=e("p",null,[e("span",{class:"font-bold"},"Volumen en CU:")],-1),T={class:"text-right"},q=e("p",null,[e("span",{class:"font-bold"},"Locaci贸n:")],-1),J={class:"text-right"},O=e("p",null,[e("span",{class:"font-bold"},"Ruta:")],-1),G={class:"text-right"},H=e("p",null,[e("span",{class:"font-bold"},"Subcanal:")],-1),I={class:"text-right"},K=e("hr",null,null,-1),Q={class:"px-2 pb-1 rounded-lg"},W=e("h3",{class:"font-bold mb-1 text-red-700 text-sm"},"EDF a solicitar",-1),X={class:"grid grid-cols-2 text-sm"},Y=e("p",null,[e("span",{class:"font-bold"},"Condici贸n:")],-1),Z={class:"text-right"},$=e("p",null,[e("span",{class:"font-bold"},"Puertas a negociar:")],-1),ee={class:"text-right"},te=e("p",null,[e("span",{class:"font-bold"},"Motivo:")],-1),oe={class:"text-right"},se=e("p",null,[e("span",{class:"font-bold"},"Justificaci贸n:")],-1),ae={class:"text-right"},re={key:1,class:"mt-6 flex justify-between"},ne={class:"mt-2 text-center"};function ie(s,o,l,le,t,n){const m=c("PermutaRejectReasonModal"),p=c("PermutaRejectedModal"),f=c("PermutaApproveConfirmationModal"),_=c("PermutaApprovedModal");return i(),u("div",y,[e("div",D,[e("button",{onClick:o[0]||(o[0]=(...a)=>n.closeModal&&n.closeModal(...a)),class:"absolute top-1 right-1 text-gray-500 hover:text-gray-700"},j),t.showDetails?(i(),u("div",C,[e("div",P,[A,e("p",k,"Aprobado por: "+r(t.approvedBy),1)]),e("div",null,[t.errorMessage?(i(),u("div",S,r(t.errorMessage),1)):d("",!0),e("div",E,[e("div",B,[e("div",N,[L,e("p",V,r(t.formData.clientCode),1),U,e("p",z,r(new Date(l.permuta.created_at).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})),1),F,e("p",T,r(t.formData.volumeCU),1),q,e("p",J,r(t.formData.location),1),O,e("p",G,r(t.formData.route),1),H,e("p",I,r(t.formData.subcanal),1)])]),K,e("div",Q,[W,e("div",X,[Y,e("p",Z,r(t.formData.condition),1),$,e("p",ee,r(t.formData.doorsToNegotiate),1),te,e("p",oe,r(t.formData.reason),1),se,e("p",ae,r(t.formData.justification),1)])])]),l.permuta.gerente_status=="Pending"?(i(),u("div",re,[e("button",{onClick:o[1]||(o[1]=(...a)=>n.approvePermuta&&n.approvePermuta(...a)),class:"w-1/2 py-1 font-medium rounded-md bg-green-500 text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-opacity-50 mr-2"}," Aprobar "),e("button",{onClick:o[2]||(o[2]=(...a)=>n.rejectPermuta&&n.rejectPermuta(...a)),class:"w-1/2 py-1 font-medium rounded-md bg-red-500 text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-opacity-50 ml-2"}," Rechazar ")])):d("",!0),e("div",ne,[e("button",{onClick:o[3]||(o[3]=(...a)=>n.closeModal&&n.closeModal(...a)),class:"w-full bg-black text-white px-2 py-1 rounded-lg hover:bg-red-600 focus:outline-none text-sm"},"Cerrar")])])])):d("",!0),t.showRejectReasonModal?(i(),h(m,{key:1,"permuta-id":l.permuta.id,onShowDetailsModal:n.detailsModal,onShowRejectedModal:o[4]||(o[4]=a=>t.showRejectedModal=!0),onClose:o[5]||(o[5]=a=>t.showRejectReasonModal=!1)},null,8,["permuta-id","onShowDetailsModal"])):d("",!0),t.showRejectedModal?(i(),h(p,{key:2,"permuta-id":l.permuta.id,onClose:o[6]||(o[6]=a=>t.showRejectedModal=!1)},null,8,["permuta-id"])):d("",!0),t.showApproveConfirmationModal?(i(),h(f,{key:3,"permuta-id":l.permuta.id,sv:l.sv,onShowDetailsModal:n.detailsModal,onClose:o[7]||(o[7]=a=>t.showApproveConfirmationModal=!1),onShowApprovedModal:o[8]||(o[8]=a=>t.showApprovedModal=!0)},null,8,["permuta-id","sv","onShowDetailsModal"])):d("",!0),t.showApprovedModal?(i(),h(_,{key:4,"permuta-id":l.permuta.id,onClose:o[9]||(o[9]=a=>t.showApprovedModal=!1)},null,8,["permuta-id"])):d("",!0)])])}const fe=b(x,[["render",ie]]);export{fe as default};
