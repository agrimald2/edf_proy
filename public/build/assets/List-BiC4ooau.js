import{_ as v}from"./GuestLayout-onSU9uyW.js";import y from"./PermutaItem-DzfpoXcw.js";import P from"./PermutaDetails-DSSo_LIV.js";import{j as D,l as u,o as l,c as m,w as k,a as e,g as h,t as n,m as _,y as C,e as i,h as p,F as x,s as M,n as L,f as F}from"./app-DhCoEYep.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Banner-X1wRBWQm.js";import"./PermutaRejectReasonModal-CxZ-WJ3F.js";import"./PermutaApproveConfirmationModal-BhlViYB_.js";import"./PermutaApprovedModal-DySM9hP9.js";import"./PermutaRejectedModal-B248GGZ2.js";const B={components:{GuestLayout:v,PermutaItem:y,PermutaDetails:P},props:{mesa:String,haveAvailableLimit:Boolean},data(){return{todaysDate:new Date().toLocaleDateString("es-ES",{weekday:"short",year:"numeric",month:"short",day:"numeric"}).replace(/^\w/,t=>t.toUpperCase()),selectedFilter:"todos",selectedMonth:new Date().toLocaleString("es-ES",{month:"long"}).toLowerCase(),permutas:[],searchQuery:"",showDetailModal:!1,selectedPermuta:null,months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],filters:["todos","approved","rejected","pending"]}},computed:{filteredPermutas(){return this.permutas.filter(t=>{const r=t.trade_status.toLowerCase(),d=t.supervisor_status.toLowerCase(),c=t.gerente_status.toLowerCase(),o=r==="rejected"||d==="rejected"||c==="rejected",a=r==="pending"&&!o;return this.selectedFilter==="todos"?!0:this.selectedFilter==="approved"?r==="approved":this.selectedFilter==="rejected"?o:this.selectedFilter==="pending"?a:c===this.selectedFilter}).filter(t=>this.selectedMonth!=="todos"?new Date(t.created_at).getMonth()===this.months.indexOf(this.selectedMonth):t.cod_cliente.includes(this.searchQuery)||t.location.name.includes(this.searchQuery))},sortedPermutas(){return this.filteredPermutas.sort((t,r)=>t.supervisor_status==="Pending"?-1:1)},approvedCount(){return this.permutas.filter(t=>t.trade_status.toLowerCase()==="approved").length},pendingCount(){return this.permutas.filter(t=>t.supervisor_status.toLowerCase()==="pending").length}},methods:{async getPermutas(){try{const t=await D.get(`/api/supervisor/${this.mesa}/permutas`);this.permutas=t.data}catch(t){console.error("Error fetching permutas:",t)}},openDetailModal(t){this.selectedPermuta=t,this.showDetailModal=!0},closeDetailModal(){this.showDetailModal=!1,this.selectedPermuta=null},goBack(){window.location.href=`/mesa/${this.mesa}/info`},goToPendingPermutas(){window.location.href=`/supervisor/${this.mesa}/dashboard/permutas/pending`}},mounted(){this.getPermutas()}},S={class:"flex items-center justify-between px-4 py-2 bg-white shadow-md border-b border-gray-200"},E=e("i",{class:"fa-solid fa-chevron-left font-bold"},null,-1),Q=[E],T=e("h3",{class:"text-center text-sm font-bold text-gray-800 flex-1"},"Permutas",-1),V={class:"flex flex-row gap-2 bg-white shadow-md rounded-lg overflow-hidden p-2 items-center"},U={class:"flex-1 text-center text-xs"},z=e("span",{class:"font-bold"}," Aprobadas: ",-1),A={class:"flex-1 text-center text-xs text-black"},G=e("span",{class:"font-bold"},"Pendientes: ",-1),I={class:"flex-1 text-center"},N=e("label",{class:"text-xs font-semibold mr-2"},"Mes:",-1),O=e("option",{value:"todos"},"todos",-1),R=["value"],q={class:"px-2 flex justify-between items-center my-4"},H=e("h2",{class:"font-bold text-sm text-black leading-tight"},"Lista de Permutas",-1),J={class:"absolute -bottom-1 -left-2 inline-block w-4 h-4 bg-red-500 text-white text-xxs font-bold rounded-full text-center"},K={class:"px-2"},W={class:"relative text-gray-600 w-full"},X={class:"flex gap-1 my-2 px-1 overflow-x-auto no-scrollbar"},Y=["onClick"],Z={class:"p-2 overflow-hidden shadow-xl sm:rounded-lg"},$={class:"flex flex-col gap-4"};function ee(t,r,d,c,o,a){const g=u("PermutaItem"),b=u("PermutaDetails"),w=u("GuestLayout");return l(),m(w,{title:"Permutas | EDF"},{default:k(()=>[e("div",S,[e("button",{onClick:r[0]||(r[0]=(...s)=>a.goBack&&a.goBack(...s)),class:"text-black text-sm hover:text-gray-800"},Q),T]),e("div",V,[e("div",U,[z,h(" "+n(a.approvedCount),1)]),e("div",A,[G,h(" "+n(a.pendingCount),1)]),e("div",I,[N,_(e("select",{"onUpdate:modelValue":r[1]||(r[1]=s=>o.selectedMonth=s),class:"border border-gray-300 rounded-md text-xs p-1 px-2"},[O,(l(!0),i(x,null,p(o.months,(s,f)=>(l(),i("option",{key:f,value:s},n(s.slice(0,3)),9,R))),128))],512),[[C,o.selectedMonth]])])]),e("div",q,[H,e("button",{onClick:r[2]||(r[2]=(...s)=>a.goToPendingPermutas&&a.goToPendingPermutas(...s)),class:"relative border border-black text-black font-semibold px-4 py-1 rounded ml-4 text-xs"},[h(" Permutas por aprobar "),e("span",J,n(a.pendingCount),1)])]),e("div",K,[e("div",W,[_(e("input",{class:"border-2 border-gray-300 bg-white h-10 px-5 pr-16 rounded-lg text-sm focus:outline-none w-full",type:"search",placeholder:"Buscar","onUpdate:modelValue":r[3]||(r[3]=s=>o.searchQuery=s)},null,512),[[M,o.searchQuery]])])]),e("div",X,[(l(!0),i(x,null,p(o.filters,s=>(l(),i("button",{key:s,class:L(["px-1 py-0.5 text-xxs rounded-full border-black border",{"bg-black text-white":o.selectedFilter===s,"bg-white text-black":o.selectedFilter!==s}]),onClick:f=>o.selectedFilter=s,style:{"font-size":"12px"}},n(s.charAt(0).toUpperCase()+s.slice(1)),11,Y))),128))]),e("div",Z,[e("div",$,[(l(!0),i(x,null,p(a.sortedPermutas,s=>(l(),m(g,{key:s.id,permuta:s,showDetailModal:o.showDetailModal,selectedPermuta:o.selectedPermuta,sv:d.mesa,onOpenDetailModal:a.openDetailModal},null,8,["permuta","showDetailModal","selectedPermuta","sv","onOpenDetailModal"]))),128))])]),o.showDetailModal?(l(),m(b,{key:0,show:o.showDetailModal,permuta:o.selectedPermuta,onClose:a.closeDetailModal,sv:d.mesa},null,8,["show","permuta","onClose","sv"])):F("",!0)]),_:1})}const ue=j(B,[["render",ee]]);export{ue as default};
