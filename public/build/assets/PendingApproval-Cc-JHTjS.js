import{_ as p}from"./GuestLayout-n9QUaYHi.js";import m from"./PendingPermutaItem-BIKKfQRG.js";import{s as h,i as d,o as r,c as l,w as f,a as t,e as n,F as g,h as _}from"./app-CYQM2K1X.js";import{_ as w}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Banner-Boh43R_R.js";import"./PermutaDetails-B9I37gFw.js";import"./PermutaRejectReasonModal-BBcK_QQz.js";import"./PermutaApproveConfirmationModal-BKoO4trP.js";import"./PermutaApprovedModal-CgXarK74.js";import"./PermutaRejectedModal-K0sD1ABn.js";const y={components:{GuestLayout:p,PendingPermutaItem:m},props:{mesa:{type:String},haveAvailableLimit:{type:Boolean}},data(){return{todaysDate:new Date().toLocaleDateString("es-ES",{weekday:"short",year:"numeric",month:"short",day:"numeric"}).replace(/^\w/,e=>e.toUpperCase()),selectedFilter:"todos",permutas:[],searchQuery:"",showDetailModal:!1,selectedPermuta:null,showAddPermutaModal:!1}},computed:{filteredPermutas(){return this.permutas.filter(e=>this.selectedFilter==="todos"?!0:this.selectedFilter==="approved"?e.trade_status.toLowerCase()==="approved":this.selectedFilter==="rejected"?e.trade_status.toLowerCase()==="rejected"||e.supervisor_status.toLowerCase()==="rejected"||e.gerente_status.toLowerCase()==="rejected":this.selectedFilter==="pending"?e.trade_status.toLowerCase()==="pending"&&e.supervisor_status.toLowerCase()!=="rejected"&&e.gerente_status.toLowerCase()!=="rejected":e.gerente_status.toLowerCase()===this.selectedFilter).filter(e=>e.cod_cliente.includes(this.searchQuery)||e.location.name.includes(this.searchQuery))},sortedPermutas(){return this.filteredPermutas.sort((e,s)=>e.supervisor_status==="Pending"&&s.supervisor_status!=="Pending"?-1:e.supervisor_status!=="Pending"&&s.supervisor_status==="Pending"?1:0)},approvedCount(){return this.permutas.filter(e=>e.trade_status.toLowerCase()==="approved").length},pendingCount(){return this.permutas.filter(e=>e.trade_status.toLowerCase()==="pending"&&e.supervisor_status.toLowerCase()!=="rejected"&&e.gerente_status.toLowerCase()!=="rejected").length}},methods:{async getPermutas(){try{const e=await h.get(`/api/supervisor/${this.mesa}/permutas/pending`);this.permutas=e.data}catch(e){console.error("Error fetching permutas:",e)}},statusClass(e){switch(e.toLowerCase()){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},statusIcon(e){switch(e.toLowerCase()){case"approved":return"fa-solid fa-check";case"rejected":return"fa-solid fa-x";case"pending":return"fa-solid fa-spinner";default:return"fa-solid fa-question"}},openDetailModal(e){this.selectedPermuta=e,this.showDetailModal=!0},goBack(){window.location.href=`/supervisor/${this.mesa}/dashboard/permutas`}},mounted(){this.getPermutas()}},v={class:"flex items-center justify-between px-4 py-2 bg-white shadow-md border-b border-gray-200"},x=t("i",{class:"fa-solid fa-chevron-left font-bold"},null,-1),P=[x],C=t("h3",{class:"text-center text-sm font-bold text-gray-800 flex-1"},"Permutas por aprobar",-1),L=t("div",{class:"px-2 flex justify-between items-center my-4"},[t("h2",{class:"font-bold text-sm text-black leading-tight"}," Lista de Permutas ")],-1),b={class:"p-2 overflow-hidden shadow-xl sm:rounded-lg"},k={key:0,class:"text-center text-gray-500"},D={key:1,class:"flex flex-col gap-4"};function j(e,s,M,F,i,a){const u=d("PendingPermutaItem"),c=d("GuestLayout");return r(),l(c,{title:"Permutas | EDF"},{default:f(()=>[t("div",v,[t("button",{onClick:s[0]||(s[0]=o=>a.goBack()),class:"text-black text-sm hover:text-gray-800"},P),C]),L,t("div",b,[a.sortedPermutas.length===0?(r(),n("div",k," No hay permutas por aprobar. ")):(r(),n("div",D,[(r(!0),n(g,null,_(a.sortedPermutas,o=>(r(),l(u,{key:o.id,permuta:o,showDetailModal:i.showDetailModal,selectedPermuta:i.selectedPermuta,onOpenDetailModal:a.openDetailModal},null,8,["permuta","showDetailModal","selectedPermuta","onOpenDetailModal"]))),128))]))])]),_:1})}const q=w(y,[["render",j]]);export{q as default};
